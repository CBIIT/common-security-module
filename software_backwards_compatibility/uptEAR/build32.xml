<project name="UPT Project" basedir="./.." default="all">
	<description>UPT Project Build File</description>

	<target name="init32">
		<property name="app.name32" value="upt32" />
		<property name="src.home32" value="${basedir}/${app.name32}/webapp/src" />
		<property name="web.home32" value="${basedir}/${app.name32}/webapp/public_html" />
		<property name="webinf.home32" value="${web.home32}/WEB-INF" />
		<property name="lib.home32" value="${webinf.home32}/lib" />
		<property name="otherlib.home32" value="${basedir}/${app.name32}/otherlib" />
		<property name="build.home32" value="${basedir}/${app.name32}/build" />
		<property name="dist.home32" value="${basedir}/${app.name32}/dist" />
		<property name="classes.home32" value="${webinf.home32}/classes" />
		<property name="war.file32" value="${dist.home32}/${app.name32}.war" />
	</target>




	<target name="clean32" depends="init32" description="Delete the Build and Dist directories">
		<delete dir="${build.home32}" />
		<delete dir="${dist.home32}" />
	</target>


	<target name="prepareDir32" depends="init32">
		<mkdir dir="${build.home32}" />
		<mkdir dir="${build.home32}/WEB-INF" />
		<mkdir dir="${build.home32}/WEB-INF/tld" />
		<mkdir dir="${build.home32}/WEB-INF/conf" />
		<mkdir dir="${build.home32}/WEB-INF/lib" />
		<mkdir dir="${build.home32}/META-INF" />
		<mkdir dir="${classes.home32}" />
		<mkdir dir="${dist.home32}" />
	</target>




	<target name="prepareBuild32" depends="prepareDir32">

		<copy todir="${build.home32}">
			<fileset dir="${web.home32}" />
		</copy>

		<copy todir="${build.home32}/WEB-INF/">
			<fileset dir="${webinf.home32}" />
		</copy>

		<copy todir="${build.home32}/WEB-INF/lib">
			<fileset dir="${lib.home32}" includes="**/*.jar" />
		</copy>
		<delete quiet="true" file="${build.home32}/WEB-INF/lib/commons-logging.jar" />
		<delete quiet="true" file="${build.home32}/WEB-INF/lib/commons-logging-1.0.4.jar" />
		<delete quiet="true" file="${build.home32}/WEB-INF/lib/log4j-1.2.9.jar" />
		<delete quiet="true" file="${build.home32}/WEB-INF/lib/jta.jar" />
		<delete quiet="true" file="${build.home32}/WEB-INF/lib/clm.jar" />
	</target>


	<target name="prepare32" depends="prepareDir32,prepareBuild32" />

	<target name="compile32" depends="init32,prepare32" description="Compiles all the files in the project">
		<javac srcdir="${src.home32}" destdir="${build.home32}/WEB-INF/classes" debug="true" deprecation="true">
			<classpath>
				<fileset dir="${lib.home32}" includes="*.jar" />
				<fileset dir="${otherlib.home32}" includes="*.jar" />
			</classpath>
		</javac>
		<copy todir="${build.home32}/WEB-INF/classes">
			<fileset dir="${src.home32}" excludes="**/*.java" />
		</copy>
		<delete quiet="true" file="${build.home32}/WEB-INF/classes/gov/nih/nci/security/upt/resources/ApplicationSecurityConfig.xml" />
		<delete quiet="true" file="${build.home32}/WEB-INF/classes/gov/nih/nci/security/upt/resources/csmupt.hibernate.cfg.xml" />
		<delete quiet="true" file="${build.home32}/WEB-INF/classes/gov/nih/nci/security/upt/resources/security.hibernate.cfg.xml" />
		<delete quiet="true" file="${build.home32}/WEB-INF/classes/gov/nih/nci/security/upt/resources/hibernate.properties" />
		<delete quiet="true" file="${build.home32}/WEB-INF/classes/gov/nih/nci/security/upt/resources/ObjectStateLoggerConfig.xml" />
	</target>

	<target name="dist32" depends="init32,compile32" description="Creates war file">
		<copy todir="${dist.home32}">
			<fileset dir="${basedir}/upt32/resources">
				<exclude name="ObjectStateLoggerConfig.xml" />
			</fileset>
		</copy>
		<jar jarfile="${war.file32}" basedir="${build.home32}" />
		<!--<copy todir="${dist.home32}" file="${lib.home32}/clm.jar"  />-->
	</target>

	<target name="cleanup32" depends="dist32" description="Delete the Build directory">
		<delete dir="${build.home32}" />
	</target>

	


	<target name="all" depends="dist32,cleanup32" description="Builds and deploys the entire application by cleaning the build and dist directories" />

</project>