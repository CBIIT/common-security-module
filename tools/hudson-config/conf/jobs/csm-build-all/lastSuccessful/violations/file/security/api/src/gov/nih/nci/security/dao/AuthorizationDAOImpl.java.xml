<?xml version="1.0" encoding="UTF-8"?>

<!--L
   Copyright Ekagra Software Technologies Ltd.
   Copyright SAIC, SAIC-Frederick

   Distributed under the OSI-approved BSD 3-Clause License.
   See http://ncip.github.com/common-security-module/LICENSE.txt for details.
L-->

<file
  name="security/api/src/gov/nih/nci/security/dao/AuthorizationDAOImpl.java"
  last-modified="1212512038000"
  file="/home/csmuser/hudson/jobs/csm-build-all/workspace/security/api/src/gov/nih/nci/security/dao/AuthorizationDAOImpl.java"
>
  <violation
    line="125"
    source="UnusedImportsCheck"
    severity="Medium High"
    type="checkstyle"
    message="Unused import - java.sql.Statement."
    severity-level="1"
    popup-message="Unused import - java.sql.Statement."
  />
  <violation
    line="160"
    source="ClassDataAbstractionCouplingCheck"
    severity="Medium High"
    type="checkstyle"
    message="Class Data Abstraction Coupling is 28 (max allowed is 7) classes [Application, ArrayList, CSConfigurationException, CSException, CSObjectNotFoundException, CSTransactionException, Date, Group, GroupSearchCriteria, HashMap, HashSet, Hashtable, ObjectAccessMap, ObjectPrivilegeMap, Principal, Privilege, ProtectionElement, ProtectionElementPrivilegeContext, ProtectionElementSearchCriteria, ProtectionGroup, ProtectionGroupProtectionElement, ProtectionGroupRoleContext, Role, StringEncrypter, TreeSet, User, UserGroup, UserGroupRoleProtectionGroup]."
    severity-level="1"
    popup-message="Class Data Abstraction Coupling is 28 (max allowed is 7) classes [Application, ArrayList, CSConfigurationException, CSException, CSObjectNotFoundException, CSTransactionException, Date, Group, GroupSearchCriteria, HashMap, HashSet, Hashtable, ObjectAccessMap, ObjectPrivilegeMap, Principal, Privilege, ProtectionElement, ProtectionElementPrivilegeContext, ProtectionElementSearchCriteria, ProtectionGroup, ProtectionGroupProtectionElement, ProtectionGroupRoleContext, Role, StringEncrypter, TreeSet, User, UserGroup, UserGroupRoleProtectionGroup]."
  />
  <violation
    line="160"
    source="ClassFanOutComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Class Fan-Out Complexity is 54 (max allowed is 20)."
    severity-level="1"
    popup-message="Class Fan-Out Complexity is 54 (max allowed is 20)."
  />
  <violation
    line="252"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 15 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 15 (max allowed is 10)."
  />
  <violation
    line="353"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 14 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 14 (max allowed is 10)."
  />
  <violation
    line="353"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 515 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 515 (max allowed is 200)."
  />
  <violation
    line="437"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="504"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="581"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 12 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 12 (max allowed is 10)."
  />
  <violation
    line="763"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="872"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 13 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 13 (max allowed is 10)."
  />
  <violation
    line="1032"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 13 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 13 (max allowed is 10)."
  />
  <violation
    line="1032"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 320 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 320 (max allowed is 200)."
  />
  <violation
    line="1145"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 12 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 12 (max allowed is 10)."
  />
  <violation
    line="1145"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 320 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 320 (max allowed is 200)."
  />
  <violation
    line="1206"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 12 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 12 (max allowed is 10)."
  />
  <violation
    line="1206"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 320 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 320 (max allowed is 200)."
  />
  <violation
    line="1274"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 16 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 16 (max allowed is 10)."
  />
  <violation
    line="1274"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 1,744 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 1,744 (max allowed is 200)."
  />
  <violation
    line="1558"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 12 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 12 (max allowed is 10)."
  />
  <violation
    line="1757"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="2165"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="2415"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="2543"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 17 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 17 (max allowed is 10)."
  />
  <violation
    line="2543"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 704 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 704 (max allowed is 200)."
  />
  <violation
    line="2647"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="2856"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="2944"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="3145"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="3232"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 13 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 13 (max allowed is 10)."
  />
  <violation
    line="3232"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 260 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 260 (max allowed is 200)."
  />
  <violation
    line="3342"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 13 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 13 (max allowed is 10)."
  />
  <violation
    line="3342"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 260 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 260 (max allowed is 200)."
  />
  <violation
    line="3457"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="3550"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="3640"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 18 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 18 (max allowed is 10)."
  />
  <violation
    line="3737"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 18 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 18 (max allowed is 10)."
  />
  <violation
    line="4193"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="4320"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 11 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 11 (max allowed is 10)."
  />
  <violation
    line="4570"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 12 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 12 (max allowed is 10)."
  />
  <violation
    line="4721"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 17 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 17 (max allowed is 10)."
  />
  <violation
    line="4721"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 704 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 704 (max allowed is 200)."
  />
  <violation
    line="4819"
    source="CyclomaticComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="Cyclomatic Complexity is 15 (max allowed is 10)."
    severity-level="1"
    popup-message="Cyclomatic Complexity is 15 (max allowed is 10)."
  />
  <violation
    line="4819"
    source="NPathComplexityCheck"
    severity="Medium High"
    type="checkstyle"
    message="NPath Complexity is 208 (max allowed is 200)."
    severity-level="1"
    popup-message="NPath Complexity is 208 (max allowed is 200)."
  />
  <violation
    line="194"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line203'&gt;line 203&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 203."
  />
  <violation
    line="203"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line194'&gt;line 194&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 194."
  />
  <violation
    line="438"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line2263'&gt;line 2263&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 2263."
  />
  <violation
    line="458"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line2283'&gt;line 2283&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 2283."
  />
  <violation
    line="465"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line533'&gt;line 533&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 533."
  />
  <violation
    line="467"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 720, line 810, line 930, line 2120, line 2207, line 2302, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866 and line 535."
  />
  <violation
    line="467"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 12 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 12 lines from line 641."
  />
  <violation
    line="484"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 552, line 662, line 738, line 830, line 951, line 2036, line 2138, line 2228, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="485"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt; and &lt;a href='#line553'&gt;line 553&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663 and line 553."
  />
  <violation
    line="533"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line465'&gt;line 465&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 465."
  />
  <violation
    line="535"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt; and &lt;a href='#line467'&gt;line 467&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 720, line 810, line 930, line 2120, line 2207, line 2302, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866 and line 467."
  />
  <violation
    line="552"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 484, line 662, line 738, line 830, line 951, line 2036, line 2138, line 2228, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="553"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663 and line 485."
  />
  <violation
    line="584"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 17 lines from &lt;a href='#line876'&gt;line 876&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 17 lines from line 876."
  />
  <violation
    line="608"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line2191'&gt;line 2191&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 2191."
  />
  <violation
    line="613"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 14 lines from &lt;a href='#line906'&gt;line 906&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 14 lines from line 906."
  />
  <violation
    line="628"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 12 lines from &lt;a href='#line921'&gt;line 921&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 12 lines from line 921."
  />
  <violation
    line="641"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt;, &lt;a href='#line467'&gt;line 467&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 720, line 810, line 930, line 2120, line 2207, line 2302, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866, line 467 and line 535."
  />
  <violation
    line="641"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 12 lines from &lt;a href='#line467'&gt;line 467&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 12 lines from line 467."
  />
  <violation
    line="654"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line2220'&gt;line 2220&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 2220."
  />
  <violation
    line="662"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 484, line 552, line 738, line 830, line 951, line 2036, line 2138, line 2228, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="662"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 14 lines from &lt;a href='#line2228'&gt;line 2228&lt;/a&gt; and &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 14 lines from line 2228 and line 2747."
  />
  <violation
    line="663"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 553 and line 485."
  />
  <violation
    line="663"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt; and &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 2748, line 2229, line 2523 and line 1924."
  />
  <violation
    line="663"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 13 lines from &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt; and &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 13 lines from line 2748, line 2229 and line 1924."
  />
  <violation
    line="720"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt;, &lt;a href='#line467'&gt;line 467&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 810, line 930, line 2120, line 2207, line 2302, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866, line 467 and line 535."
  />
  <violation
    line="738"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 484, line 552, line 662, line 830, line 951, line 2036, line 2138, line 2228, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="739"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 663, line 553 and line 485."
  />
  <violation
    line="766"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 20 lines from &lt;a href='#line2858'&gt;line 2858&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 20 lines from line 2858."
  />
  <violation
    line="810"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt;, &lt;a href='#line467'&gt;line 467&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 720, line 930, line 2120, line 2207, line 2302, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866, line 467 and line 535."
  />
  <violation
    line="810"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 12 lines from &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 12 lines from line 2805."
  />
  <violation
    line="830"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 484, line 552, line 662, line 738, line 951, line 2036, line 2138, line 2228, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="830"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 14 lines from &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 14 lines from line 2825."
  />
  <violation
    line="831"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="876"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 15 lines from &lt;a href='#line584'&gt;line 584&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 15 lines from line 584."
  />
  <violation
    line="906"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 14 lines from &lt;a href='#line613'&gt;line 613&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 14 lines from line 613."
  />
  <violation
    line="921"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line628'&gt;line 628&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 628."
  />
  <violation
    line="930"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt;, &lt;a href='#line467'&gt;line 467&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 720, line 810, line 2120, line 2207, line 2302, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866, line 467 and line 535."
  />
  <violation
    line="951"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 484, line 552, line 662, line 738, line 830, line 2036, line 2138, line 2228, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="952"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="1071"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 10 lines from &lt;a href='#line1494'&gt;line 1494&lt;/a&gt;, &lt;a href='#line1430'&gt;line 1430&lt;/a&gt; and &lt;a href='#line1362'&gt;line 1362&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 10 lines from line 1494, line 1430 and line 1362."
  />
  <violation
    line="1080"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 11 lines from &lt;a href='#line4658'&gt;line 4658&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 11 lines from line 4658."
  />
  <violation
    line="1086"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line1516'&gt;line 1516&lt;/a&gt;, &lt;a href='#line1451'&gt;line 1451&lt;/a&gt; and &lt;a href='#line1383'&gt;line 1383&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 1516, line 1451 and line 1383."
  />
  <violation
    line="1147"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 19 lines from &lt;a href='#line1208'&gt;line 1208&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 19 lines from line 1208."
  />
  <violation
    line="1174"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 30 lines from &lt;a href='#line1235'&gt;line 1235&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 30 lines from line 1235."
  />
  <violation
    line="1208"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 19 lines from &lt;a href='#line1147'&gt;line 1147&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 19 lines from line 1147."
  />
  <violation
    line="1235"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 30 lines from &lt;a href='#line1174'&gt;line 1174&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 30 lines from line 1174."
  />
  <violation
    line="1344"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line1476'&gt;line 1476&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 1476."
  />
  <violation
    line="1345"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 13 lines from &lt;a href='#line1410'&gt;line 1410&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 13 lines from line 1410."
  />
  <violation
    line="1362"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line1494'&gt;line 1494&lt;/a&gt;, &lt;a href='#line1430'&gt;line 1430&lt;/a&gt; and &lt;a href='#line1071'&gt;line 1071&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 1494, line 1430 and line 1071."
  />
  <violation
    line="1362"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 43 lines from &lt;a href='#line1430'&gt;line 1430&lt;/a&gt; and &lt;a href='#line1494'&gt;line 1494&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 43 lines from line 1430 and line 1494."
  />
  <violation
    line="1383"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line1086'&gt;line 1086&lt;/a&gt;, &lt;a href='#line1516'&gt;line 1516&lt;/a&gt; and &lt;a href='#line1451'&gt;line 1451&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 1086, line 1516 and line 1451."
  />
  <violation
    line="1410"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 15 lines from &lt;a href='#line1345'&gt;line 1345&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 15 lines from line 1345."
  />
  <violation
    line="1430"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line1494'&gt;line 1494&lt;/a&gt;, &lt;a href='#line1362'&gt;line 1362&lt;/a&gt; and &lt;a href='#line1071'&gt;line 1071&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 1494, line 1362 and line 1071."
  />
  <violation
    line="1430"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 43 lines from &lt;a href='#line1362'&gt;line 1362&lt;/a&gt; and &lt;a href='#line1494'&gt;line 1494&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 43 lines from line 1362 and line 1494."
  />
  <violation
    line="1451"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line1086'&gt;line 1086&lt;/a&gt;, &lt;a href='#line1516'&gt;line 1516&lt;/a&gt; and &lt;a href='#line1383'&gt;line 1383&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 1086, line 1516 and line 1383."
  />
  <violation
    line="1476"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line1344'&gt;line 1344&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 1344."
  />
  <violation
    line="1494"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line1430'&gt;line 1430&lt;/a&gt;, &lt;a href='#line1362'&gt;line 1362&lt;/a&gt; and &lt;a href='#line1071'&gt;line 1071&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 1430, line 1362 and line 1071."
  />
  <violation
    line="1494"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 44 lines from &lt;a href='#line1362'&gt;line 1362&lt;/a&gt; and &lt;a href='#line1430'&gt;line 1430&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 44 lines from line 1362 and line 1430."
  />
  <violation
    line="1516"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line1086'&gt;line 1086&lt;/a&gt;, &lt;a href='#line1451'&gt;line 1451&lt;/a&gt; and &lt;a href='#line1383'&gt;line 1383&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 1086, line 1451 and line 1383."
  />
  <violation
    line="1564"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line1647'&gt;line 1647&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 1647."
  />
  <violation
    line="1574"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 36 lines from &lt;a href='#line1657'&gt;line 1657&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 36 lines from line 1657."
  />
  <violation
    line="1621"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line1698'&gt;line 1698&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 1698."
  />
  <violation
    line="1627"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="1647"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line1564'&gt;line 1564&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 1564."
  />
  <violation
    line="1657"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 36 lines from &lt;a href='#line1574'&gt;line 1574&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 36 lines from line 1574."
  />
  <violation
    line="1698"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line1621'&gt;line 1621&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 1621."
  />
  <violation
    line="1805"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="1875"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1805, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="1924"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1981, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="1924"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt; and &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 2748, line 2229, line 663 and line 2523."
  />
  <violation
    line="1924"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 12 lines from &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt; and &lt;a href='#line663'&gt;line 663&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 12 lines from line 2748, line 2229 and line 663."
  />
  <violation
    line="1947"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 15 lines from &lt;a href='#line2506'&gt;line 2506&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 15 lines from line 2506."
  />
  <violation
    line="1981"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 2037, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="2036"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 484, line 552, line 662, line 738, line 830, line 951, line 2138, line 2228, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="2037"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 6 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 6 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2139, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="2099"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line2348'&gt;line 2348&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 2348."
  />
  <violation
    line="2120"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt;, &lt;a href='#line467'&gt;line 467&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 720, line 810, line 930, line 2207, line 2302, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866, line 467 and line 535."
  />
  <violation
    line="2138"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 484, line 552, line 662, line 738, line 830, line 951, line 2036, line 2228, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="2139"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2229, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="2167"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 10 lines from &lt;a href='#line2417'&gt;line 2417&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 10 lines from line 2417."
  />
  <violation
    line="2183"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line2433'&gt;line 2433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 2433."
  />
  <violation
    line="2191"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line608'&gt;line 608&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 608."
  />
  <violation
    line="2194"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 12 lines from &lt;a href='#line2444'&gt;line 2444&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 12 lines from line 2444."
  />
  <violation
    line="2207"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt;, &lt;a href='#line467'&gt;line 467&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 720, line 810, line 930, line 2120, line 2302, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866, line 467 and line 535."
  />
  <violation
    line="2220"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line654'&gt;line 654&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 654."
  />
  <violation
    line="2228"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 484, line 552, line 662, line 738, line 830, line 951, line 2036, line 2138, line 2322, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="2228"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 14 lines from &lt;a href='#line662'&gt;line 662&lt;/a&gt; and &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 14 lines from line 662 and line 2747."
  />
  <violation
    line="2229"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2323, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="2229"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt; and &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 2748, line 663, line 2523 and line 1924."
  />
  <violation
    line="2229"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 13 lines from &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt; and &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 13 lines from line 2748, line 663 and line 1924."
  />
  <violation
    line="2263"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 10 lines from &lt;a href='#line438'&gt;line 438&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 10 lines from line 438."
  />
  <violation
    line="2283"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 12 lines from &lt;a href='#line458'&gt;line 458&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 12 lines from line 458."
  />
  <violation
    line="2302"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2369'&gt;line 2369&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt;, &lt;a href='#line467'&gt;line 467&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 720, line 810, line 930, line 2120, line 2207, line 2369, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866, line 467 and line 535."
  />
  <violation
    line="2322"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 8 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2387'&gt;line 2387&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 8 lines from line 484, line 552, line 662, line 738, line 830, line 951, line 2036, line 2138, line 2228, line 2387, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="2323"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2388'&gt;line 2388&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2388, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <violation
    line="2348"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line2099'&gt;line 2099&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 2099."
  />
  <violation
    line="2369"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 7 lines from &lt;a href='#line641'&gt;line 641&lt;/a&gt;, &lt;a href='#line720'&gt;line 720&lt;/a&gt;, &lt;a href='#line810'&gt;line 810&lt;/a&gt;, &lt;a href='#line930'&gt;line 930&lt;/a&gt;, &lt;a href='#line2120'&gt;line 2120&lt;/a&gt;, &lt;a href='#line2207'&gt;line 2207&lt;/a&gt;, &lt;a href='#line2302'&gt;line 2302&lt;/a&gt;, &lt;a href='#line2462'&gt;line 2462&lt;/a&gt;, &lt;a href='#line2599'&gt;line 2599&lt;/a&gt;, &lt;a href='#line2681'&gt;line 2681&lt;/a&gt;, &lt;a href='#line2805'&gt;line 2805&lt;/a&gt;, &lt;a href='#line2904'&gt;line 2904&lt;/a&gt;, &lt;a href='#line2989'&gt;line 2989&lt;/a&gt;, &lt;a href='#line3108'&gt;line 3108&lt;/a&gt;, &lt;a href='#line3693'&gt;line 3693&lt;/a&gt;, &lt;a href='#line3792'&gt;line 3792&lt;/a&gt;, &lt;a href='#line4017'&gt;line 4017&lt;/a&gt;, &lt;a href='#line4095'&gt;line 4095&lt;/a&gt;, &lt;a href='#line4463'&gt;line 4463&lt;/a&gt;, &lt;a href='#line4777'&gt;line 4777&lt;/a&gt;, &lt;a href='#line4866'&gt;line 4866&lt;/a&gt;, &lt;a href='#line467'&gt;line 467&lt;/a&gt; and &lt;a href='#line535'&gt;line 535&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 7 lines from line 641, line 720, line 810, line 930, line 2120, line 2207, line 2302, line 2462, line 2599, line 2681, line 2805, line 2904, line 2989, line 3108, line 3693, line 3792, line 4017, line 4095, line 4463, line 4777, line 4866, line 467 and line 535."
  />
  <violation
    line="2387"
    source="duplication"
    severity="Medium"
    type="simian"
    message="Duplication of 10 lines from &lt;a href='#line484'&gt;line 484&lt;/a&gt;, &lt;a href='#line552'&gt;line 552&lt;/a&gt;, &lt;a href='#line662'&gt;line 662&lt;/a&gt;, &lt;a href='#line738'&gt;line 738&lt;/a&gt;, &lt;a href='#line830'&gt;line 830&lt;/a&gt;, &lt;a href='#line951'&gt;line 951&lt;/a&gt;, &lt;a href='#line2036'&gt;line 2036&lt;/a&gt;, &lt;a href='#line2138'&gt;line 2138&lt;/a&gt;, &lt;a href='#line2228'&gt;line 2228&lt;/a&gt;, &lt;a href='#line2322'&gt;line 2322&lt;/a&gt;, &lt;a href='#line2481'&gt;line 2481&lt;/a&gt;, &lt;a href='#line2619'&gt;line 2619&lt;/a&gt;, &lt;a href='#line2702'&gt;line 2702&lt;/a&gt;, &lt;a href='#line2747'&gt;line 2747&lt;/a&gt;, &lt;a href='#line2825'&gt;line 2825&lt;/a&gt;, &lt;a href='#line2922'&gt;line 2922&lt;/a&gt;, &lt;a href='#line3009'&gt;line 3009&lt;/a&gt;, &lt;a href='#line3195'&gt;line 3195&lt;/a&gt;, &lt;a href='#line3874'&gt;line 3874&lt;/a&gt;, &lt;a href='#line3920'&gt;line 3920&lt;/a&gt;, &lt;a href='#line3968'&gt;line 3968&lt;/a&gt;, &lt;a href='#line4036'&gt;line 4036&lt;/a&gt;, &lt;a href='#line4115'&gt;line 4115&lt;/a&gt;, &lt;a href='#line4418'&gt;line 4418&lt;/a&gt;, &lt;a href='#line4481'&gt;line 4481&lt;/a&gt;, &lt;a href='#line4797'&gt;line 4797&lt;/a&gt;, &lt;a href='#line4887'&gt;line 4887&lt;/a&gt;, &lt;a href='#line3272'&gt;line 3272&lt;/a&gt;, &lt;a href='#line3321'&gt;line 3321&lt;/a&gt;, &lt;a href='#line3383'&gt;line 3383&lt;/a&gt; and &lt;a href='#line3433'&gt;line 3433&lt;/a&gt;."
    severity-level="2"
    popup-message="Duplication of 10 lines from line 484, line 552, line 662, line 738, line 830, line 951, line 2036, line 2138, line 2228, line 2322, line 2481, line 2619, line 2702, line 2747, line 2825, line 2922, line 3009, line 3195, line 3874, line 3920, line 3968, line 4036, line 4115, line 4418, line 4481, line 4797, line 4887, line 3272, line 3321, line 3383 and line 3433."
  />
  <violation
    line="2388"
    source="duplication"
    severity="Low"
    type="simian"
    message="Duplication of 9 lines from &lt;a href='#line4888'&gt;line 4888&lt;/a&gt;, &lt;a href='#line4798'&gt;line 4798&lt;/a&gt;, &lt;a href='#line4482'&gt;line 4482&lt;/a&gt;, &lt;a href='#line4419'&gt;line 4419&lt;/a&gt;, &lt;a href='#line4116'&gt;line 4116&lt;/a&gt;, &lt;a href='#line4037'&gt;line 4037&lt;/a&gt;, &lt;a href='#line3969'&gt;line 3969&lt;/a&gt;, &lt;a href='#line3921'&gt;line 3921&lt;/a&gt;, &lt;a href='#line3875'&gt;line 3875&lt;/a&gt;, &lt;a href='#line3812'&gt;line 3812&lt;/a&gt;, &lt;a href='#line3713'&gt;line 3713&lt;/a&gt;, &lt;a href='#line3436'&gt;line 3436&lt;/a&gt;, &lt;a href='#line3384'&gt;line 3384&lt;/a&gt;, &lt;a href='#line3324'&gt;line 3324&lt;/a&gt;, &lt;a href='#line3273'&gt;line 3273&lt;/a&gt;, &lt;a href='#line3197'&gt;line 3197&lt;/a&gt;, &lt;a href='#line3128'&gt;line 3128&lt;/a&gt;, &lt;a href='#line3078'&gt;line 3078&lt;/a&gt;, &lt;a href='#line3010'&gt;line 3010&lt;/a&gt;, &lt;a href='#line2923'&gt;line 2923&lt;/a&gt;, &lt;a href='#line2826'&gt;line 2826&lt;/a&gt;, &lt;a href='#line2748'&gt;line 2748&lt;/a&gt;, &lt;a href='#line2703'&gt;line 2703&lt;/a&gt;, &lt;a href='#line2620'&gt;line 2620&lt;/a&gt;, &lt;a href='#line2523'&gt;line 2523&lt;/a&gt;, &lt;a href='#line2482'&gt;line 2482&lt;/a&gt;, &lt;a href='#line2323'&gt;line 2323&lt;/a&gt;, &lt;a href='#line2229'&gt;line 2229&lt;/a&gt;, &lt;a href='#line2139'&gt;line 2139&lt;/a&gt;, &lt;a href='#line2037'&gt;line 2037&lt;/a&gt;, &lt;a href='#line1981'&gt;line 1981&lt;/a&gt;, &lt;a href='#line1924'&gt;line 1924&lt;/a&gt;, &lt;a href='#line1875'&gt;line 1875&lt;/a&gt;, &lt;a href='#line1805'&gt;line 1805&lt;/a&gt;, &lt;a href='#line1627'&gt;line 1627&lt;/a&gt;, &lt;a href='#line952'&gt;line 952&lt;/a&gt;, &lt;a href='#line831'&gt;line 831&lt;/a&gt;, &lt;a href='#line739'&gt;line 739&lt;/a&gt;, &lt;a href='#line663'&gt;line 663&lt;/a&gt;, &lt;a href='#line553'&gt;line 553&lt;/a&gt; and &lt;a href='#line485'&gt;line 485&lt;/a&gt;."
    severity-level="4"
    popup-message="Duplication of 9 lines from line 4888, line 4798, line 4482, line 4419, line 4116, line 4037, line 3969, line 3921, line 3875, line 3812, line 3713, line 3436, line 3384, line 3324, line 3273, line 3197, line 3128, line 3078, line 3010, line 2923, line 2826, line 2748, line 2703, line 2620, line 2523, line 2482, line 2323, line 2229, line 2139, line 2037, line 1981, line 1924, line 1875, line 1805, line 1627, line 952, line 831, line 739, line 663, line 553 and line 485."
  />
  <line number='116'>import gov.nih.nci.security.util.StringEncrypter.EncryptionException;</line>
  <line number='117'></line>
  <line number='118'>import java.lang.reflect.Field;</line>
  <line number='119'>import java.lang.reflect.Method;</line>
  <line number='120'>import java.lang.reflect.Modifier;</line>
  <line number='121'>import java.security.Principal;</line>
  <line number='122'>import java.sql.Connection;</line>
  <line number='123'>import java.sql.PreparedStatement;</line>
  <line number='124'>import java.sql.ResultSet;</line>
  <line number='125'>import java.sql.Statement;</line>
  <line number='126'>import java.util.ArrayList;</line>
  <line number='127'>import java.util.Collection;</line>
  <line number='128'>import java.util.Collections;</line>
  <line number='129'>import java.util.Date;</line>
  <line number='130'>import java.util.Enumeration;</line>
  <line number='131'>import java.util.HashMap;</line>
  <line number='132'>import java.util.HashSet;</line>
  <line number='133'>import java.util.Hashtable;</line>
  <line number='134'>import java.util.Iterator;</line>
  <line number='135'>import java.util.List;</line>
  <line number='151'>import org.hibernate.exception.GenericJDBCException;</line>
  <line number='152'></line>
  <line number='153'>import org.apache.log4j.Logger;</line>
  <line number='154'></line>
  <line number='155'></line>
  <line number='156'>/**</line>
  <line number='157'> * @author parmarv</line>
  <line number='158'> *</line>
  <line number='159'> */</line>
  <line number='160'>public class AuthorizationDAOImpl implements AuthorizationDAO {</line>
  <line number='161'></line>
  <line number='162'>	static final Logger log = Logger.getLogger(AuthorizationDAOImpl.class.getName());</line>
  <line number='163'>	</line>
  <line number='164'>	/**</line>
  <line number='165'>	 * auditLog is an instance of Logger , which is used for Audit Logging</line>
  <line number='166'>	 */</line>
  <line number='167'>	private static final Logger auditLog = Logger.getLogger("CSM.Audit.Logging.Event.Authorization");		</line>
  <line number='168'></line>
  <line number='169'>	</line>
  <line number='170'>	private SessionFactory sf = null;</line>
  <line number='185'>	public AuthorizationDAOImpl(SessionFactory sf, String applicationContextName) throws CSConfigurationException {</line>
  <line number='186'>		setHibernateSessionFactory(sf);</line>
  <line number='187'>		Application app;</line>
  <line number='188'>		try</line>
  <line number='189'>		{</line>
  <line number='190'>			app = this.getApplicationByName(applicationContextName);</line>
  <line number='191'>		}</line>
  <line number='192'>		catch (CSObjectNotFoundException e)</line>
  <line number='193'>		{</line>
  <line number='194'>			if (log.isDebugEnabled())</line>
  <line number='195'>				log</line>
  <line number='196'>						.debug("Authorization|"</line>
  <line number='197'>								+ applicationContextName</line>
  <line number='198'>								+ "||AuthorizationDAOImpl|Failure|No Application found for the Context Name|");</line>
  <line number='199'>			throw new CSConfigurationException(</line>
  <line number='200'>					"No Application found for the Context Name. "+e.getMessage());</line>
  <line number='201'>		}</line>
  <line number='202'>		if (app == null) {</line>
  <line number='203'>			if (log.isDebugEnabled())</line>
  <line number='204'>				log</line>
  <line number='205'>						.debug("Authorization|"</line>
  <line number='206'>								+ applicationContextName</line>
  <line number='207'>								+ "||AuthorizationDAOImpl|Failure|No Application found for the Context Name|");</line>
  <line number='208'>			throw new CSConfigurationException(</line>
  <line number='209'>					"Unable to retrieve Application with this Context Name");</line>
  <line number='210'>		}</line>
  <line number='211'>		this.setApplication(app);</line>
  <line number='212'>		if (log.isDebugEnabled())</line>
  <line number='213'>			log</line>
  <line number='243'>		else</line>
  <line number='244'>			cacheLevel = 2;</line>
  <line number='245'>		</line>
  <line number='246'>		if (log.isDebugEnabled())</line>
  <line number='247'>			log.debug("Authorization|" + applicationContextName + "||AuthorizationDAOImpl|Success|Instantiated AuthorizationDAOImpl|");</line>
  <line number='248'>		</line>
  <line number='249'>	}</line>
  <line number='250'>	</line>
  <line number='251'>	</line>
  <line number='252'>	private void populateCache(String userOrGroupName, boolean isUserName)</line>
  <line number='253'>	{</line>
  <line number='254'>		Collection protectionElementPrivilegeContexts = null;</line>
  <line number='255'>		if (isUserName)</line>
  <line number='256'>		{</line>
  <line number='257'>			User user = getUser(userOrGroupName);</line>
  <line number='258'>			if (user == null)</line>
  <line number='259'>			{</line>
  <line number='260'>				throw new RuntimeException ("User Name doesnot Exist");</line>
  <line number='261'>			}</line>
  <line number='262'>			try</line>
  <line number='344'>		this.sf = sf;</line>
  <line number='345'>	}</line>
  <line number='346'></line>
  <line number='347'>	/*</line>
  <line number='348'>	 * (non-Javadoc)</line>
  <line number='349'>	 * </line>
  <line number='350'>	 * @see gov.nih.nci.security.UserProvisioningManager#assignUserToGroup(java.lang.String,</line>
  <line number='351'>	 *      java.lang.String)</line>
  <line number='352'>	 */</line>
  <line number='353'>	public void assignUserToGroup(String userName, String groupName)</line>
  <line number='354'>			throws CSTransactionException {</line>
  <line number='355'>		Session s = null;</line>
  <line number='356'>		Transaction t = null;</line>
  <line number='357'>		try {</line>
  <line number='358'>			if (StringUtilities.isBlank(userName)) {</line>
  <line number='359'>				throw new CSTransactionException("The userName can't be null");</line>
  <line number='360'>			}</line>
  <line number='361'>			if (StringUtilities.isBlank(groupName)) {</line>
  <line number='362'>				throw new CSTransactionException("The groupName can't be null");</line>
  <line number='363'>			}</line>
  <line number='428'></line>
  <line number='429'>			} catch (Exception ex2) {</line>
  <line number='430'>			}</line>
  <line number='431'>		}</line>
  <line number='432'>		auditLog.info("Assigning User " + userName + " to Group " + groupName);</line>
  <line number='433'>		</line>
  <line number='434'></line>
  <line number='435'>	}</line>
  <line number='436'></line>
  <line number='437'>	public void assignGroupsToUser(String userId, String[] groupIds)</line>
  <line number='438'>			throws CSTransactionException {</line>
  <line number='439'>		Session s = null;</line>
  <line number='440'>		Transaction t = null;</line>
  <line number='441'>		try {</line>
  <line number='442'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='443'>			</line>
  <line number='444'></line>
  <line number='445'>			User user = (User) this.getObjectByPrimaryKey(s, User.class,</line>
  <line number='446'>					new Long(userId));</line>
  <line number='447'>			</line>
  <line number='448'>			HashSet newGroups = new HashSet();</line>
  <line number='449'>			for (int k = 0; k &lt; groupIds.length; k++) {</line>
  <line number='450'>				Group group = (Group) this.getObjectByPrimaryKey(Group.class,</line>
  <line number='451'>						groupIds[k]);</line>
  <line number='452'>				if (group != null) {</line>
  <line number='453'>					newGroups.add(group);</line>
  <line number='454'>				}</line>
  <line number='455'>			}</line>
  <line number='456'></line>
  <line number='457'>			user.setGroups(newGroups);</line>
  <line number='458'>			try {</line>
  <line number='459'>				user = (User) performEncrytionDecryption(user, true);</line>
  <line number='460'>			} catch (EncryptionException e) {</line>
  <line number='461'>				throw new CSObjectNotFoundException(e);</line>
  <line number='462'>			}</line>
  <line number='463'>			t = s.beginTransaction();</line>
  <line number='464'>			s.update(user);</line>
  <line number='465'>			t.commit();</line>
  <line number='466'>			s.flush();</line>
  <line number='467'>		} catch (Exception ex) {</line>
  <line number='468'>			log.error(ex);</line>
  <line number='469'>			try {</line>
  <line number='470'>				t.rollback();</line>
  <line number='471'>			} catch (Exception ex3) {</line>
  <line number='472'>				if (log.isDebugEnabled())</line>
  <line number='473'>					log</line>
  <line number='474'>							.debug("Authorization|||assignGroupsToUser|Failure|Error in Rolling Back Transaction|"</line>
  <line number='475'>									+ ex3.getMessage());</line>
  <line number='476'>			}</line>
  <line number='477'>			if (log.isDebugEnabled())</line>
  <line number='478'>				log</line>
  <line number='479'>						.debug("Authorization|||assignGroupsToUser|Failure|Error occurred in assigning Groups "</line>
  <line number='480'>								+ StringUtilities.stringArrayToString(groupIds)</line>
  <line number='481'>								+ " to User " + userId + "|" + ex.getMessage());</line>
  <line number='482'>			throw new CSTransactionException(</line>
  <line number='483'>					"An error occurred in assigning Groups to User\n"</line>
  <line number='484'>							+ ex.getMessage(), ex);</line>
  <line number='485'>		} finally {</line>
  <line number='486'>			try {</line>
  <line number='487'>				</line>
  <line number='488'>				s.close();</line>
  <line number='489'>			} catch (Exception ex2) {</line>
  <line number='490'>				if (log.isDebugEnabled())</line>
  <line number='491'>					log</line>
  <line number='492'>							.debug("Authorization|||assignGroupsToUser|Failure|Error in Closing Session |"</line>
  <line number='493'>									+ ex2.getMessage());</line>
  <line number='494'>			}</line>
  <line number='495'>		}</line>
  <line number='496'>		if (log.isDebugEnabled())</line>
  <line number='497'>			log</line>
  <line number='498'>					.debug("Authorization|||assignGroupsToUser|Success|Successful in assigning Groups "</line>
  <line number='499'>							+ StringUtilities.stringArrayToString(groupIds)</line>
  <line number='500'>							+ " to User " + userId + "|");</line>
  <line number='501'>		auditLog.info("Assigning User " + userId + " to Groups");		</line>
  <line number='502'>	}</line>
  <line number='503'></line>
  <line number='504'>	public void assignUsersToGroup(String groupId, String[] userIds)</line>
  <line number='505'>	throws CSTransactionException {</line>
  <line number='506'>		Session s = null;</line>
  <line number='507'>		Transaction t = null;</line>
  <line number='508'>		try {</line>
  <line number='509'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='510'>			</line>
  <line number='511'>		</line>
  <line number='512'>			Group group = (Group) this.getObjectByPrimaryKey(s, Group.class,</line>
  <line number='513'>					new Long(groupId));</line>
  <line number='514'>			</line>
  <line number='524'>				</line>
  <line number='525'>				if (user != null) {</line>
  <line number='526'>					newUsers.add(user);</line>
  <line number='527'>				}</line>
  <line number='528'>			}</line>
  <line number='529'>		</line>
  <line number='530'>			group.setUsers(newUsers);</line>
  <line number='531'>			t = s.beginTransaction();</line>
  <line number='532'>			s.update(group);</line>
  <line number='533'>			t.commit();</line>
  <line number='534'>			s.flush();</line>
  <line number='535'>		} catch (Exception ex) {</line>
  <line number='536'>			log.error(ex);</line>
  <line number='537'>			try {</line>
  <line number='538'>				t.rollback();</line>
  <line number='539'>			} catch (Exception ex3) {</line>
  <line number='540'>				if (log.isDebugEnabled())</line>
  <line number='541'>					log</line>
  <line number='542'>							.debug("Authorization|||assignUsersToGroup|Failure|Error in Rolling Back Transaction|"</line>
  <line number='543'>									+ ex3.getMessage());</line>
  <line number='544'>			}</line>
  <line number='545'>			if (log.isDebugEnabled())</line>
  <line number='546'>				log</line>
  <line number='547'>						.debug("Authorization|||assignUsersToGroup|Failure|Error occurred in assigning Users "</line>
  <line number='548'>								+ StringUtilities.stringArrayToString(userIds)</line>
  <line number='549'>								+ " to Group " + groupId + "|" + ex.getMessage());</line>
  <line number='550'>			throw new CSTransactionException(</line>
  <line number='551'>					"An error occurred in assigning Users to Group\n"</line>
  <line number='552'>							+ ex.getMessage(), ex);</line>
  <line number='553'>		} finally {</line>
  <line number='554'>			try {</line>
  <line number='555'>				</line>
  <line number='556'>				s.close();</line>
  <line number='557'>			} catch (Exception ex2) {</line>
  <line number='558'>				if (log.isDebugEnabled())</line>
  <line number='559'>					log</line>
  <line number='560'>							.debug("Authorization|||assignUsersToGroup|Failure|Error in Closing Session |"</line>
  <line number='561'>									+ ex2.getMessage());</line>
  <line number='562'>			}</line>
  <line number='563'>		}</line>
  <line number='572'>	</line>
  <line number='573'>	</line>
  <line number='574'>	/*</line>
  <line number='575'>	 * (non-Javadoc)</line>
  <line number='576'>	 * </line>
  <line number='577'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#assignGroupRoleToProtectionGroup(java.lang.String,</line>
  <line number='578'>	 *      java.lang.String, java.lang.String)</line>
  <line number='579'>	 */</line>
  <line number='580'></line>
  <line number='581'>	public void assignGroupRoleToProtectionGroup(String protectionGroupId,</line>
  <line number='582'>			String groupId, String[] rolesId) throws CSTransactionException {</line>
  <line number='583'></line>
  <line number='584'>		Session s = null;</line>
  <line number='585'>		Transaction t = null;</line>
  <line number='586'>        ArrayList roles = new ArrayList();</line>
  <line number='587'>		try {</line>
  <line number='588'></line>
  <line number='589'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='590'>			</line>
  <line number='591'>			</line>
  <line number='592'>			for (int i = 0; i &lt; rolesId.length; i++){</line>
  <line number='593'>				Role role = (Role) this.getObjectByPrimaryKey(s, Role.class,</line>
  <line number='594'>						new Long(rolesId[i]));</line>
  <line number='599'>					.getObjectByPrimaryKey(s, ProtectionGroup.class, new Long(</line>
  <line number='600'>							protectionGroupId));</line>
  <line number='601'></line>
  <line number='602'>			Group group = (Group) this.getObjectByPrimaryKey(s, Group.class,</line>
  <line number='603'>					new Long(groupId));</line>
  <line number='604'>			</line>
  <line number='605'>						</line>
  <line number='606'>			Criteria criteria = s</line>
  <line number='607'>					.createCriteria(UserGroupRoleProtectionGroup.class);</line>
  <line number='608'>			criteria.add(Restrictions.eq("protectionGroup", pgroup));</line>
  <line number='609'>			criteria.add(Restrictions.eq("group", group));</line>
  <line number='610'>			</line>
  <line number='611'>			List list = criteria.list();</line>
  <line number='612'>			t = s.beginTransaction();</line>
  <line number='613'>			for(int k=0;k&lt;list.size();k++){</line>
  <line number='614'>				UserGroupRoleProtectionGroup ugrpg = (UserGroupRoleProtectionGroup)list.get(k);</line>
  <line number='615'>				Role r = ugrpg.getRole();</line>
  <line number='616'>				  if(!roles.contains(r)){</line>
  <line number='617'>				  	s.delete(ugrpg);</line>
  <line number='618'>				  	</line>
  <line number='619'>				  }else{</line>
  <line number='620'>				  	roles.remove(r);</line>
  <line number='621'>				  }</line>
  <line number='622'>			}</line>
  <line number='623'>			</line>
  <line number='624'>			for(int j=0;j&lt;roles.size();j++){</line>
  <line number='625'>				Role leftOverRole = (Role)roles.get(j);</line>
  <line number='626'>				UserGroupRoleProtectionGroup toBeSaved = new UserGroupRoleProtectionGroup();</line>
  <line number='627'>			  	toBeSaved.setGroup(group);</line>
  <line number='628'>			  	toBeSaved.setProtectionGroup(pgroup);</line>
  <line number='629'>			  	toBeSaved.setRole(leftOverRole);</line>
  <line number='630'>                toBeSaved.setUpdateDate(new Date());</line>
  <line number='631'>                s.save(toBeSaved);</line>
  <line number='632'>			}</line>
  <line number='633'>			</line>
  <line number='634'>			</line>
  <line number='635'></line>
  <line number='636'>			</line>
  <line number='637'></line>
  <line number='638'>			t.commit();</line>
  <line number='639'>			s.flush();</line>
  <line number='640'>			auditLog.info("Assigning Roles to Group " + group.getGroupName() + " for Protection Group " + pgroup.getProtectionGroupName());</line>
  <line number='641'>		} catch (Exception ex) {</line>
  <line number='642'>			log.error(ex);</line>
  <line number='643'>			try {</line>
  <line number='644'>				t.rollback();</line>
  <line number='645'>			} catch (Exception ex3) {</line>
  <line number='646'>				if (log.isDebugEnabled())</line>
  <line number='647'>					log</line>
  <line number='648'>							.debug("Authorization|||assignGroupsToUser|Failure|Error in Rolling Back Transaction|"</line>
  <line number='649'>									+ ex3.getMessage());</line>
  <line number='650'>			}</line>
  <line number='651'>			if (log.isDebugEnabled())</line>
  <line number='652'>				log</line>
  <line number='653'>						.debug("Authorization|||assignGroupRoleToProtectionGroup|Failure|Error Occured in assigning Roles "</line>
  <line number='654'>								+ StringUtilities.stringArrayToString(rolesId)</line>
  <line number='655'>								+ " to Group "</line>
  <line number='656'>								+ groupId</line>
  <line number='657'>								+ " and Protection Group"</line>
  <line number='658'>								+ protectionGroupId</line>
  <line number='659'>								+ "|" + ex.getMessage());</line>
  <line number='660'>			throw new CSTransactionException(</line>
  <line number='661'>					"An error occurred in assigning Protection Group and Roles to a Group\n"</line>
  <line number='662'>							+ ex.getMessage(), ex);</line>
  <line number='663'>		} finally {</line>
  <line number='664'>			try {</line>
  <line number='665'>				</line>
  <line number='666'>				s.close();</line>
  <line number='667'>			} catch (Exception ex2) {</line>
  <line number='668'>				if (log.isDebugEnabled())</line>
  <line number='669'>					log</line>
  <line number='670'>							.debug("Authorization|||assignGroupRoleToProtectionGroup|Failure|Error in Closing Session |"</line>
  <line number='671'>									+ ex2.getMessage());</line>
  <line number='672'>			}</line>
  <line number='673'>		}</line>
  <line number='711'>					newPrivs.add(pr);</line>
  <line number='712'>				}</line>
  <line number='713'>			}</line>
  <line number='714'>			role.setPrivileges(newPrivs);</line>
  <line number='715'>			t = s.beginTransaction();</line>
  <line number='716'>			s.update(role);</line>
  <line number='717'>			t.commit();</line>
  <line number='718'>			s.flush();</line>
  <line number='719'>			auditLog.info("Assigning Privileges to Role " + role.getName());</line>
  <line number='720'>		} catch (Exception ex) {</line>
  <line number='721'>			log.error(ex);</line>
  <line number='722'>			try {</line>
  <line number='723'>				t.rollback();</line>
  <line number='724'>			} catch (Exception ex3) {</line>
  <line number='725'>				if (log.isDebugEnabled())</line>
  <line number='726'>					log</line>
  <line number='727'>							.debug("Authorization|||assignPrivilegesToRole|Failure|Error in Rolling Back Transaction|"</line>
  <line number='728'>									+ ex3.getMessage());</line>
  <line number='729'>			}</line>
  <line number='730'>			if (log.isDebugEnabled())</line>
  <line number='731'>				log</line>
  <line number='732'>						.debug("Authorization|||assignPrivilegesToRole|Failure|Error Occured in assigning Privilege "</line>
  <line number='733'>								+ StringUtilities</line>
  <line number='734'>										.stringArrayToString(privilegeIds)</line>
  <line number='735'>								+ " to Role " + roleId + "|" + ex.getMessage());</line>
  <line number='736'>			throw new CSTransactionException(</line>
  <line number='737'>					"An error occurred in assigning Privileges to Role\n"</line>
  <line number='738'>							+ ex.getMessage(), ex);</line>
  <line number='739'>		} finally {</line>
  <line number='740'>			try {</line>
  <line number='741'>				</line>
  <line number='742'>				s.close();</line>
  <line number='743'>			} catch (Exception ex2) {</line>
  <line number='744'>				if (log.isDebugEnabled())</line>
  <line number='745'>					log</line>
  <line number='746'>							.debug("Authorization|||assignPrivilegesToRole|Failure|Error in Closing Session |"</line>
  <line number='747'>									+ ex2.getMessage());</line>
  <line number='748'>			}</line>
  <line number='749'>		}</line>
  <line number='754'>							+ " to Role " + roleId + "|");</line>
  <line number='755'>	}</line>
  <line number='756'></line>
  <line number='757'>	/*</line>
  <line number='758'>	 * (non-Javadoc)</line>
  <line number='759'>	 * </line>
  <line number='760'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#assignProtectionElements(java.lang.String,</line>
  <line number='761'>	 *      java.lang.String[], java.lang.String[])</line>
  <line number='762'>	 */</line>
  <line number='763'>	public void assignProtectionElement(String protectionGroupName,</line>
  <line number='764'>			String protectionElementObjectId,</line>
  <line number='765'>			String protectionElementAttributeName)</line>
  <line number='766'>			throws CSTransactionException {</line>
  <line number='767'></line>
  <line number='768'>		Session s = null;</line>
  <line number='769'>		Transaction t = null;</line>
  <line number='770'>		try {</line>
  <line number='771'></line>
  <line number='772'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='773'>			t = s.beginTransaction();</line>
  <line number='774'></line>
  <line number='775'>			if (StringUtilities.isBlank(protectionGroupName)) {</line>
  <line number='776'>				throw new CSTransactionException(</line>
  <line number='801'>				s.save(pgpe);</line>
  <line number='802'>			} else {</line>
  <line number='803'>				throw new CSTransactionException(</line>
  <line number='804'>						"This association already exist!");</line>
  <line number='805'>			}</line>
  <line number='806'></line>
  <line number='807'>			t.commit();</line>
  <line number='808'>			s.flush();</line>
  <line number='809'>			auditLog.info("Assigning Protection Element with Object Id " + protectionElementObjectId + "Attribute " + protectionElementAttributeName + "to Protection Group" + protectionGroupName);</line>
  <line number='810'>		} catch (Exception ex) {</line>
  <line number='811'>			log.error(ex);</line>
  <line number='812'>			try {</line>
  <line number='813'>				t.rollback();</line>
  <line number='814'>			} catch (Exception ex3) {</line>
  <line number='815'>				if (log.isDebugEnabled())</line>
  <line number='816'>					log</line>
  <line number='817'>							.debug("Authorization|||assignProtectionElements|Failure|Error in Rolling Back Transaction|"</line>
  <line number='818'>									+ ex3.getMessage());</line>
  <line number='819'>			}</line>
  <line number='820'>			if (log.isDebugEnabled())</line>
  <line number='821'>				log</line>
  <line number='822'>						.debug("Authorization|||assignProtectionElements|Failure|Error Occured in assigning Protection Element with Object Id "</line>
  <line number='823'>								+ protectionElementObjectId</line>
  <line number='824'>								+ " with protection element attribute "</line>
  <line number='825'>								+ protectionElementAttributeName</line>
  <line number='826'>								+ " to protection group name: "</line>
  <line number='827'>								+ protectionGroupName + "|" + ex.getMessage());</line>
  <line number='828'>			throw new CSTransactionException(</line>
  <line number='829'>					"An error occurred in assigning Protection Element to Protection Group\n"</line>
  <line number='830'>							+ ex.getMessage(), ex);</line>
  <line number='831'>		} finally {</line>
  <line number='832'>			try {</line>
  <line number='833'>				</line>
  <line number='834'>				s.close();</line>
  <line number='835'>			} catch (Exception ex2) {</line>
  <line number='836'>				if (log.isDebugEnabled())</line>
  <line number='837'>					log</line>
  <line number='838'>							.debug("Authorization|||assignProtectionElements|Failure|Error in Closing Session |"</line>
  <line number='839'>									+ ex2.getMessage());</line>
  <line number='840'>			}</line>
  <line number='841'>		}</line>
  <line number='863'></line>
  <line number='864'>	}</line>
  <line number='865'></line>
  <line number='866'>	/*</line>
  <line number='867'>	 * (non-Javadoc)</line>
  <line number='868'>	 * </line>
  <line number='869'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#assignUserRoleToProtectionGroup(java.lang.String,</line>
  <line number='870'>	 *      java.lang.String[], java.lang.String)</line>
  <line number='871'>	 */</line>
  <line number='872'>	public void assignUserRoleToProtectionGroup(String userId,</line>
  <line number='873'>			String[] rolesId, String protectionGroupId)</line>
  <line number='874'>			throws CSTransactionException {</line>
  <line number='875'>		</line>
  <line number='876'>		Session s = null;</line>
  <line number='877'>		Transaction t = null;</line>
  <line number='878'>		ArrayList roles = new ArrayList();</line>
  <line number='879'></line>
  <line number='880'>		try {</line>
  <line number='881'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='882'>			</line>
  <line number='883'>			for (int i = 0; i &lt; rolesId.length; i++){</line>
  <line number='884'>				Role role = (Role) this.getObjectByPrimaryKey(s, Role.class,</line>
  <line number='885'>						new Long(rolesId[i]));</line>
  <line number='886'>				roles.add(role);</line>
  <line number='897'>				throw new CSObjectNotFoundException(e);</line>
  <line number='898'>			}</line>
  <line number='899'>			</line>
  <line number='900'>			Criteria criteria = s.createCriteria(UserGroupRoleProtectionGroup.class);</line>
  <line number='901'>			criteria.add(Restrictions.eq("protectionGroup", pgroup));</line>
  <line number='902'>			criteria.add(Restrictions.eq("user", user));</line>
  <line number='903'>			</line>
  <line number='904'>			t = s.beginTransaction();</line>
  <line number='905'>			List list = criteria.list();</line>
  <line number='906'>			for(int k=0;k&lt;list.size();k++){</line>
  <line number='907'>				UserGroupRoleProtectionGroup ugrpg = (UserGroupRoleProtectionGroup)list.get(k);</line>
  <line number='908'>				Role r = ugrpg.getRole();</line>
  <line number='909'>				  if(!roles.contains(r)){</line>
  <line number='910'>				  	s.delete(ugrpg);</line>
  <line number='911'>				  	</line>
  <line number='912'>				  }else{</line>
  <line number='913'>				  	roles.remove(r);</line>
  <line number='914'>				  }</line>
  <line number='915'>			}</line>
  <line number='916'>			</line>
  <line number='917'>			for(int j=0;j&lt;roles.size();j++){</line>
  <line number='918'>				Role leftOverRole = (Role)roles.get(j);</line>
  <line number='919'>				UserGroupRoleProtectionGroup toBeSaved = new UserGroupRoleProtectionGroup();</line>
  <line number='920'>			  	toBeSaved.setUser(user);</line>
  <line number='921'>			  	toBeSaved.setProtectionGroup(pgroup);</line>
  <line number='922'>			  	toBeSaved.setRole(leftOverRole);</line>
  <line number='923'>                toBeSaved.setUpdateDate(new Date());</line>
  <line number='924'>                s.save(toBeSaved);</line>
  <line number='925'>			}</line>
  <line number='926'>			</line>
  <line number='927'>			t.commit();</line>
  <line number='928'>			s.flush();</line>
  <line number='929'>			auditLog.info("Assigning Roles to User " + user.getLoginName() + " for Protection Group " + pgroup.getProtectionGroupName());</line>
  <line number='930'>		} catch (Exception ex) {</line>
  <line number='931'>			log.error(ex);</line>
  <line number='932'>			try {</line>
  <line number='933'>				t.rollback();</line>
  <line number='934'>			} catch (Exception ex3) {</line>
  <line number='935'>				if (log.isDebugEnabled())</line>
  <line number='936'>					log</line>
  <line number='937'>							.debug("Authorization|||assignUserRoleToProtectionGroup|Failure|Error in Rolling Back Transaction|"</line>
  <line number='938'>									+ ex3.getMessage());</line>
  <line number='939'>			}</line>
  <line number='940'>			if (log.isDebugEnabled())</line>
  <line number='942'>						.debug("Authorization|||assignGroupRoleToProtectionGroup|Failure|Error Occured in assigning Roles "</line>
  <line number='943'>								+ StringUtilities.stringArrayToString(rolesId)</line>
  <line number='944'>								+ " to User "</line>
  <line number='945'>								+ userId</line>
  <line number='946'>								+ " and Protection Group"</line>
  <line number='947'>								+ protectionGroupId</line>
  <line number='948'>								+ "|" + ex.getMessage());</line>
  <line number='949'>			throw new CSTransactionException(</line>
  <line number='950'>					"An error occurred in assigning Protection Group and Roles to a User\n"</line>
  <line number='951'>							+ ex.getMessage(), ex);</line>
  <line number='952'>		} finally {</line>
  <line number='953'>			try {</line>
  <line number='954'>				</line>
  <line number='955'>				s.close();</line>
  <line number='956'>			} catch (Exception ex2) {</line>
  <line number='957'>				if (log.isDebugEnabled())</line>
  <line number='958'>					log</line>
  <line number='959'>							.debug("Authorization|||assignUserRoleToProtectionGroup|Failure|Error in Closing Session |"</line>
  <line number='960'>									+ ex2.getMessage());</line>
  <line number='961'>			}</line>
  <line number='962'>		}</line>
  <line number='1023'>		return test;</line>
  <line number='1024'>	}</line>
  <line number='1025'></line>
  <line number='1026'>	/*</line>
  <line number='1027'>	 * (non-Javadoc)</line>
  <line number='1028'>	 * </line>
  <line number='1029'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#checkPermission(java.lang.String,</line>
  <line number='1030'>	 *      java.lang.String, java.lang.String, java.lang.String)</line>
  <line number='1031'>	 */</line>
  <line number='1032'>	public boolean checkPermission(String userName, String objectId,</line>
  <line number='1033'>			String attributeName, String privilegeName) throws CSException {</line>
  <line number='1034'></line>
  <line number='1035'>		ResultSet rs = null;</line>
  <line number='1036'>		PreparedStatement preparedStatement = null;</line>
  <line number='1037'>		boolean test = false;</line>
  <line number='1038'>		Session s = null;</line>
  <line number='1039'></line>
  <line number='1040'>		Connection connection = null;</line>
  <line number='1041'>		if (StringUtilities.isBlank(userName)) {</line>
  <line number='1042'>			throw new CSException("user name can't be null!");</line>
  <line number='1062'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1063'></line>
  <line number='1064'>			connection = s.connection();</line>
  <line number='1065'>			</line>
  <line number='1066'></line>
  <line number='1067'>			</line>
  <line number='1068'>			preparedStatement = Queries.getQueryForUserAndGroupForAttribute(userName,</line>
  <line number='1069'>					objectId, attributeName, privilegeName, this.application.getApplicationId().intValue(), connection);</line>
  <line number='1070'>			</line>
  <line number='1071'>			rs = preparedStatement.executeQuery();</line>
  <line number='1072'></line>
  <line number='1073'>			if (rs.next()) {</line>
  <line number='1074'>				test = true;</line>
  <line number='1075'>			}</line>
  <line number='1076'>			rs.close();</line>
  <line number='1077'></line>
  <line number='1078'>			preparedStatement.close();</line>
  <line number='1079'></line>
  <line number='1080'>		} catch (Exception ex) {</line>
  <line number='1081'>			if (log.isDebugEnabled())</line>
  <line number='1082'>				log.debug("Failed to get privileges for " + userName + "|"</line>
  <line number='1083'>						+ ex.getMessage());</line>
  <line number='1084'>			throw new CSException("Failed to get privileges for " + userName</line>
  <line number='1085'>					+ "|" + ex.getMessage(), ex);</line>
  <line number='1086'>		} finally {</line>
  <line number='1087'>			try {</line>
  <line number='1088'>				</line>
  <line number='1089'>				s.close();</line>
  <line number='1090'>				rs.close();</line>
  <line number='1091'>				preparedStatement.close();</line>
  <line number='1092'>			} catch (Exception ex2) {</line>
  <line number='1093'>				if (log.isDebugEnabled())</line>
  <line number='1094'>					log</line>
  <line number='1095'>							.debug("Authorization|||getPrivilegeMap|Failure|Error in Closing Session |"</line>
  <line number='1096'>									+ ex2.getMessage());</line>
  <line number='1136'>			test = this.checkPermissionForUser(userName, objectId,</line>
  <line number='1137'>					privilegeName);</line>
  <line number='1138'></line>
  <line number='1139'>			return test;</line>
  <line number='1140'>		}</line>
  <line number='1141'></line>
  <line number='1142'>		return test;</line>
  <line number='1143'>	}</line>
  <line number='1144'>	</line>
  <line number='1145'>	public boolean checkPermissionForGroup(String groupName, String objectId, String attributeName, String privilegeName) throws CSException</line>
  <line number='1146'>	{</line>
  <line number='1147'>		boolean hasAccess = false;</line>
  <line number='1148'></line>
  <line number='1149'>		Session session = null;</line>
  <line number='1150'>		PreparedStatement preparedStatement = null;</line>
  <line number='1151'>		ResultSet resultSet = null;</line>
  <line number='1152'>		Connection connection = null;</line>
  <line number='1153'>		</line>
  <line number='1154'>		if (StringUtilities.isBlank(groupName)) {</line>
  <line number='1155'>			throw new CSException("Group name can't be null!");</line>
  <line number='1156'>		}</line>
  <line number='1157'>		if (StringUtilities.isBlank(objectId)) {</line>
  <line number='1165'>		if (cacheLevel == 2 &amp;&amp; localUserOrGroupName.equals(groupName))</line>
  <line number='1166'>			return checkCachedPermission(groupName, objectId, attributeName, privilegeName);</line>
  <line number='1167'>		</line>
  <line number='1168'>		try {</line>
  <line number='1169'></line>
  <line number='1170'>			session = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1171'>			connection = session.connection();</line>
  <line number='1172'>			</line>
  <line number='1173'>			preparedStatement = Queries.getQueryForCheckPermissionForOnlyGroup(groupName, objectId, attributeName, privilegeName, this.application.getApplicationId().intValue(),connection);</line>
  <line number='1174'>			resultSet = preparedStatement.executeQuery();</line>
  <line number='1175'>			if (resultSet.next())</line>
  <line number='1176'>			{</line>
  <line number='1177'>				hasAccess = true;</line>
  <line number='1178'>			}</line>
  <line number='1179'>			resultSet.close();</line>
  <line number='1180'>			preparedStatement.close();</line>
  <line number='1181'></line>
  <line number='1182'>		} catch (Exception ex)</line>
  <line number='1183'>		{</line>
  <line number='1184'>			log.error(ex);</line>
  <line number='1197'>					log.debug("Authorization|||checkPermission|Failure|Error in Closing Session |" + ex2.getMessage());</line>
  <line number='1198'>			}</line>
  <line number='1199'>		}</line>
  <line number='1200'>		if (log.isDebugEnabled())</line>
  <line number='1201'>			log.debug("Authorization||" + groupName + "|checkPermission|Success|Successful in checking permissions with group id "	+ groupName + " object id: " + objectId	+ " and privilege name " + privilegeName + " and the result is " + hasAccess + "|");</line>
  <line number='1202'>		</line>
  <line number='1203'>		return hasAccess;</line>
  <line number='1204'>	}</line>
  <line number='1205'></line>
  <line number='1206'>	public boolean checkPermissionForGroup(String groupName, String objectId, String privilegeName) throws CSException</line>
  <line number='1207'>	{</line>
  <line number='1208'>		boolean hasAccess = false;</line>
  <line number='1209'></line>
  <line number='1210'>		Session session = null;</line>
  <line number='1211'>		PreparedStatement preparedStatement= null;</line>
  <line number='1212'>		ResultSet resultSet = null;</line>
  <line number='1213'>		Connection connection = null;</line>
  <line number='1214'>		</line>
  <line number='1215'>		if (StringUtilities.isBlank(groupName)) {</line>
  <line number='1216'>			throw new CSException("Group name can't be null!");</line>
  <line number='1217'>		}</line>
  <line number='1218'>		if (StringUtilities.isBlank(objectId)) {</line>
  <line number='1226'>		if (cacheLevel == 2 &amp;&amp; localUserOrGroupName.equals(groupName))</line>
  <line number='1227'>			return checkCachedPermission(groupName, objectId, null, privilegeName);</line>
  <line number='1228'>		</line>
  <line number='1229'>		try {</line>
  <line number='1230'></line>
  <line number='1231'>			session = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1232'>			connection = session.connection();</line>
  <line number='1233'>			</line>
  <line number='1234'>			preparedStatement= Queries.getQueryForCheckPermissionForOnlyGroup(groupName, objectId, privilegeName, this.application.getApplicationId().intValue(),connection);</line>
  <line number='1235'>			resultSet = preparedStatement.executeQuery();</line>
  <line number='1236'>			if (resultSet.next())</line>
  <line number='1237'>			{</line>
  <line number='1238'>				hasAccess = true;</line>
  <line number='1239'>			}</line>
  <line number='1240'>			resultSet.close();</line>
  <line number='1241'>			preparedStatement.close();</line>
  <line number='1242'></line>
  <line number='1243'>		} catch (Exception ex)</line>
  <line number='1244'>		{</line>
  <line number='1245'>			log.error(ex);</line>
  <line number='1265'>	}</line>
  <line number='1266'></line>
  <line number='1267'></line>
  <line number='1268'>	public List getAccessibleGroups(String objectId, String privilegeName) throws CSException</line>
  <line number='1269'>	{</line>
  <line number='1270'>	</line>
  <line number='1271'>		return getAccessibleGroups(objectId, null, privilegeName);</line>
  <line number='1272'>	}</line>
  <line number='1273'></line>
  <line number='1274'>	public List getAccessibleGroups(String objectId, String attributeName, String privilegeName) throws CSException</line>
  <line number='1275'>	{</line>
  <line number='1276'></line>
  <line number='1277'>		Session session = null;</line>
  <line number='1278'>		PreparedStatement preparedStatement = null;</line>
  <line number='1279'>		ResultSet resultSet = null;</line>
  <line number='1280'>		Connection connection = null;</line>
  <line number='1281'>		List groupIds = new ArrayList();</line>
  <line number='1282'>		List groups = null;</line>
  <line number='1283'>		</line>
  <line number='1284'>		if (StringUtilities.isBlank(objectId)) {</line>
  <line number='1335'>		for (int i = 0; i &lt; groupIds.size(); i++) {</line>
  <line number='1336'>			Group group = (Group) this.getObjectByPrimaryKey(session, Group.class, new Long(groupIds.get(i).toString()));</line>
  <line number='1337'>			groups.add(group);</line>
  <line number='1338'>		}</line>
  <line number='1339'>		</line>
  <line number='1340'>		return groups;</line>
  <line number='1341'>	}</line>
  <line number='1342'></line>
  <line number='1343'>	private boolean checkPermissionForUser(String userName, String objectId,</line>
  <line number='1344'>			String privilegeName) throws CSException {</line>
  <line number='1345'>		boolean test = false;</line>
  <line number='1346'>		Session s = null;</line>
  <line number='1347'>		PreparedStatement preparedStatement = null;</line>
  <line number='1348'>		ResultSet rs = null;</line>
  <line number='1349'>		Connection connection = null;</line>
  <line number='1350'>		if (userName == null || objectId == null || privilegeName == null) {</line>
  <line number='1351'>			return false;</line>
  <line number='1352'>		}</line>
  <line number='1353'>		try {</line>
  <line number='1354'></line>
  <line number='1355'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1356'></line>
  <line number='1357'>			connection = s.connection();</line>
  <line number='1358'></line>
  <line number='1359'>			</line>
  <line number='1360'></line>
  <line number='1361'>			preparedStatement = Queries.getQueryForCheckPermissionForUser(userName,	objectId, privilegeName, this.application.getApplicationId().intValue(),connection);</line>
  <line number='1362'>			rs = preparedStatement.executeQuery();</line>
  <line number='1363'>			if (rs.next()) {</line>
  <line number='1364'>				test = true;</line>
  <line number='1365'>			}</line>
  <line number='1366'>			rs.close();</line>
  <line number='1367'>			preparedStatement.close();</line>
  <line number='1368'></line>
  <line number='1369'>		} catch (Exception ex) {</line>
  <line number='1370'>			log.error(ex);</line>
  <line number='1371'></line>
  <line number='1372'>			if (log.isDebugEnabled())</line>
  <line number='1374'>						.debug("Authorization||"</line>
  <line number='1375'>								+ userName</line>
  <line number='1376'>								+ "|checkPermission|Failure|Error Occured in checking permissions with user id "</line>
  <line number='1377'>								+ userName + " object id: " + objectId</line>
  <line number='1378'>								+ " and privilege name " + privilegeName + "|"</line>
  <line number='1379'>								+ ex.getMessage());</line>
  <line number='1380'>			throw new CSException(</line>
  <line number='1381'>					"An error occurred while checking permissions\n"</line>
  <line number='1382'>							+ ex.getMessage(), ex);</line>
  <line number='1383'>		} finally {</line>
  <line number='1384'>			try {</line>
  <line number='1385'>				</line>
  <line number='1386'>				s.close();</line>
  <line number='1387'>				rs.close();</line>
  <line number='1388'>				preparedStatement.close();</line>
  <line number='1389'>			} catch (Exception ex2) {</line>
  <line number='1390'>				if (log.isDebugEnabled())</line>
  <line number='1391'>					log</line>
  <line number='1392'>							.debug("Authorization|||checkPermission|Failure|Error in Closing Session |"</line>
  <line number='1393'>									+ ex2.getMessage());</line>
  <line number='1401'>							+ userName + " object id: " + objectId</line>
  <line number='1402'>							+ " and privilege name " + privilegeName</line>
  <line number='1403'>							+ " and the result is " + test + "|");</line>
  <line number='1404'>		return test;</line>
  <line number='1405'>	}</line>
  <line number='1406'></line>
  <line number='1407'>	private boolean checkPermissionForUserAndGroup(String userName,</line>
  <line number='1408'>			String objectId, String privilegeName) throws CSException {</line>
  <line number='1409'>		log.debug("Method:checkPermissionForUserAndGroup()");</line>
  <line number='1410'>		boolean test = false;</line>
  <line number='1411'>		Session s = null;</line>
  <line number='1412'>		PreparedStatement preparedStatement = null;</line>
  <line number='1413'>		ResultSet rs = null;</line>
  <line number='1414'>		Connection connection = null;</line>
  <line number='1415'></line>
  <line number='1416'>		if (userName == null || objectId == null || privilegeName == null) {</line>
  <line number='1417'>			return false;</line>
  <line number='1418'>		}</line>
  <line number='1419'></line>
  <line number='1420'>		try {</line>
  <line number='1421'></line>
  <line number='1422'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1423'></line>
  <line number='1424'>			connection = s.connection();</line>
  <line number='1425'></line>
  <line number='1426'>			</line>
  <line number='1427'></line>
  <line number='1428'>			preparedStatement = Queries.getQueryForCheckPermissionForUserAndGroup(userName, objectId, privilegeName, this.application.getApplicationId().intValue(),connection);</line>
  <line number='1429'>			//log.debug("The User/Group query is: " + sql);</line>
  <line number='1430'>			rs = preparedStatement.executeQuery();</line>
  <line number='1431'>			if (rs.next()) {</line>
  <line number='1432'>				test = true;</line>
  <line number='1433'>			}</line>
  <line number='1434'>			rs.close();</line>
  <line number='1435'>			preparedStatement.close();</line>
  <line number='1436'></line>
  <line number='1437'>		} catch (Exception ex) {</line>
  <line number='1438'>			log.error(ex);</line>
  <line number='1439'></line>
  <line number='1440'>			if (log.isDebugEnabled())</line>
  <line number='1442'>						.debug("Authorization||"</line>
  <line number='1443'>								+ userName</line>
  <line number='1444'>								+ "|checkPermission|Failure|Error Occured in checking permissions with user id "</line>
  <line number='1445'>								+ userName + " object id: " + objectId</line>
  <line number='1446'>								+ " and privilege name " + privilegeName + "|"</line>
  <line number='1447'>								+ ex.getMessage());</line>
  <line number='1448'>			throw new CSException(</line>
  <line number='1449'>					"An error occurred while checking permissions\n"</line>
  <line number='1450'>							+ ex.getMessage(), ex);</line>
  <line number='1451'>		} finally {</line>
  <line number='1452'>			try {</line>
  <line number='1453'>				</line>
  <line number='1454'>				s.close();</line>
  <line number='1455'>				rs.close();</line>
  <line number='1456'>				preparedStatement.close();</line>
  <line number='1457'>			} catch (Exception ex2) {</line>
  <line number='1458'>				if (log.isDebugEnabled())</line>
  <line number='1459'>					log</line>
  <line number='1460'>							.debug("Authorization|||checkPermission|Failure|Error in Closing Session |"</line>
  <line number='1461'>									+ ex2.getMessage());</line>
  <line number='1467'>							+ userName</line>
  <line number='1468'>							+ "|checkPermission|Success|Successful in checking permissions with user id "</line>
  <line number='1469'>							+ userName + " object id: " + objectId</line>
  <line number='1470'>							+ " and privilege name " + privilegeName</line>
  <line number='1471'>							+ " and the result is " + test + "|");</line>
  <line number='1472'>		return test;</line>
  <line number='1473'>	}</line>
  <line number='1474'></line>
  <line number='1475'>	private boolean checkPermissionForUserGroup(String userName, String objectId,</line>
  <line number='1476'>			String privilegeName) throws CSException {</line>
  <line number='1477'>		boolean test = false;</line>
  <line number='1478'>		Session s = null;</line>
  <line number='1479'>		PreparedStatement preparedStatement = null;</line>
  <line number='1480'>		ResultSet rs = null;</line>
  <line number='1481'>		Connection connection = null;</line>
  <line number='1482'>		try {</line>
  <line number='1483'></line>
  <line number='1484'>			if (privilegeName == null) {</line>
  <line number='1485'>				return false;</line>
  <line number='1486'>			}</line>
  <line number='1487'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1488'></line>
  <line number='1489'>			connection = s.connection();</line>
  <line number='1490'>			</line>
  <line number='1491'>			preparedStatement= Queries.getQueryForCheckPermissionForGroup(userName,</line>
  <line number='1492'>					objectId, privilegeName, this.application.getApplicationId().intValue(),connection);</line>
  <line number='1493'>			</line>
  <line number='1494'>			rs = preparedStatement.executeQuery();</line>
  <line number='1495'>			if (rs.next()) {</line>
  <line number='1496'>				test = true;</line>
  <line number='1497'>			}</line>
  <line number='1498'>			rs.close();</line>
  <line number='1499'>			preparedStatement.close();</line>
  <line number='1500'>			</line>
  <line number='1501'></line>
  <line number='1502'>		} catch (Exception ex) {</line>
  <line number='1503'>			log.error(ex);</line>
  <line number='1504'></line>
  <line number='1507'>						.debug("Authorization||"</line>
  <line number='1508'>								+ userName</line>
  <line number='1509'>								+ "|checkPermission|Failure|Error Occured in checking permissions with user id "</line>
  <line number='1510'>								+ userName + " object id: " + objectId</line>
  <line number='1511'>								+ " and privilege name " + privilegeName + "|"</line>
  <line number='1512'>								+ ex.getMessage());</line>
  <line number='1513'>			throw new CSException(</line>
  <line number='1514'>					"An error occurred while checking permissions\n"</line>
  <line number='1515'>							+ ex.getMessage(), ex);</line>
  <line number='1516'>		} finally {</line>
  <line number='1517'>			try {</line>
  <line number='1518'>				</line>
  <line number='1519'>				s.close();</line>
  <line number='1520'>				rs.close();</line>
  <line number='1521'>				preparedStatement.close();</line>
  <line number='1522'>			} catch (Exception ex2) {</line>
  <line number='1523'>				if (log.isDebugEnabled())</line>
  <line number='1524'>					log</line>
  <line number='1525'>							.debug("Authorization|||checkPermission|Failure|Error in Closing Session |"</line>
  <line number='1526'>									+ ex2.getMessage());</line>
  <line number='1549'></line>
  <line number='1550'>		return applicationContext;</line>
  <line number='1551'>	}</line>
  <line number='1552'></line>
  <line number='1553'>	/*</line>
  <line number='1554'>	 * (non-Javadoc)</line>
  <line number='1555'>	 * </line>
  <line number='1556'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#getObjects(gov.nih.nci.security.dao.SearchCriteria)</line>
  <line number='1557'>	 */</line>
  <line number='1558'>	public List getObjects(SearchCriteria searchCriteria) {</line>
  <line number='1559'>		Session s = null;</line>
  <line number='1560'>		List result = new ArrayList();</line>
  <line number='1561'>		try {</line>
  <line number='1562'></line>
  <line number='1563'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1564'>			Criteria criteria = s</line>
  <line number='1565'>					.createCriteria(searchCriteria.getObjectType());</line>
  <line number='1566'>			Hashtable fieldValues = searchCriteria.getFieldAndValues();</line>
  <line number='1567'>			Enumeration en = fieldValues.keys();</line>
  <line number='1568'>			while (en.hasMoreElements()) {</line>
  <line number='1569'>				String str = (String) en.nextElement();</line>
  <line number='1570'>				String fieldValue = (String) fieldValues.get(str);</line>
  <line number='1571'>				String fieldValue_ = StringUtilities.replaceInString(</line>
  <line number='1572'>						fieldValue.trim(), "*", "%");</line>
  <line number='1573'>				//int i = ((String) fieldValues.get(str)).indexOf("%");</line>
  <line number='1574'>				int i = fieldValue_.indexOf("%");</line>
  <line number='1575'>				if (i != -1) {</line>
  <line number='1576'>					//criteria.add(Restrictions.like(str, fieldValues.get(str)));</line>
  <line number='1577'>					criteria.add(Restrictions.like(str, fieldValue_));</line>
  <line number='1578'>				} else {</line>
  <line number='1579'>					//criteria.add(Restrictions.eq(str, fieldValues.get(str)));</line>
  <line number='1580'>					criteria.add(Restrictions.eq(str, fieldValue_));</line>
  <line number='1581'>				}</line>
  <line number='1582'>			}</line>
  <line number='1583'>			if (fieldValues.size() == 0) {</line>
  <line number='1584'>				criteria.add(Restrictions.eqProperty("1", "1"));</line>
  <line number='1612'>			List list =  new ArrayList();</line>
  <line number='1613'> 			list = criteria.list();			</line>
  <line number='1614'>			Collections.sort(list);</line>
  <line number='1615'>			result.clear();</line>
  <line number='1616'>			result.addAll(list);</line>
  <line number='1617'></line>
  <line number='1618'>			</line>
  <line number='1619'>					</line>
  <line number='1620'></line>
  <line number='1621'>		} catch (Exception ex) {</line>
  <line number='1622'>			ex.printStackTrace();</line>
  <line number='1623'>			if (log.isDebugEnabled())</line>
  <line number='1624'>				log</line>
  <line number='1625'>						.debug("Authorization|||getObjects|Failure|Error in Obtaining Search Objects from Database |"</line>
  <line number='1626'>								+ ex.getMessage());</line>
  <line number='1627'>		} finally {</line>
  <line number='1628'>			try {</line>
  <line number='1629'>				s.close();</line>
  <line number='1630'>			} catch (Exception ex2) {</line>
  <line number='1631'>				if (log.isDebugEnabled())</line>
  <line number='1632'>					log</line>
  <line number='1633'>							.debug("Authorization|||getObjects|Failure|Error in Closing Session |"</line>
  <line number='1634'>									+ ex2.getMessage());</line>
  <line number='1635'>			}</line>
  <line number='1636'>		}</line>
  <line number='1637'>		if (log.isDebugEnabled())</line>
  <line number='1638'>			log</line>
  <line number='1639'>					.debug("Authorization|||getObjects|Success|Successful in Searching objects from the database |");</line>
  <line number='1640'>		return result;</line>
  <line number='1641'>	}</line>
  <line number='1642'></line>
  <line number='1643'>	private List getObjects(Session s, SearchCriteria searchCriteria) {</line>
  <line number='1644'>		List result = new ArrayList();</line>
  <line number='1645'>		try {</line>
  <line number='1646'></line>
  <line number='1647'>			Criteria criteria = s</line>
  <line number='1648'>					.createCriteria(searchCriteria.getObjectType());</line>
  <line number='1649'>			Hashtable fieldValues = searchCriteria.getFieldAndValues();</line>
  <line number='1650'>			Enumeration en = fieldValues.keys();</line>
  <line number='1651'>			while (en.hasMoreElements()) {</line>
  <line number='1652'>				String str = (String) en.nextElement();</line>
  <line number='1653'>				String fieldValue = (String) fieldValues.get(str);</line>
  <line number='1654'>				String fieldValue_ = StringUtilities.replaceInString(</line>
  <line number='1655'>						fieldValue, "*", "%");</line>
  <line number='1656'>				//int i = ((String) fieldValues.get(str)).indexOf("%");</line>
  <line number='1657'>				int i = fieldValue_.indexOf("%");</line>
  <line number='1658'>				if (i != -1) {</line>
  <line number='1659'>					//criteria.add(Restrictions.like(str, fieldValues.get(str)));</line>
  <line number='1660'>					criteria.add(Restrictions.like(str, fieldValue_));</line>
  <line number='1661'>				} else {</line>
  <line number='1662'>					//criteria.add(Restrictions.eq(str, fieldValues.get(str)));</line>
  <line number='1663'>					criteria.add(Restrictions.eq(str, fieldValue_));</line>
  <line number='1664'>				}</line>
  <line number='1665'>			}</line>
  <line number='1666'>			if (fieldValues.size() == 0) {</line>
  <line number='1667'>				criteria.add(Restrictions.eqProperty("1", "1"));</line>
  <line number='1689'>					.getName()</line>
  <line number='1690'>					.equalsIgnoreCase(</line>
  <line number='1691'>							"gov.nih.nci.security.authorization.domainobjects.Application"))) {</line>
  <line number='1692'>				criteria.add(Restrictions.eq("application", this.application));</line>
  <line number='1693'>			}</line>
  <line number='1694'></line>
  <line number='1695'>			result = criteria.list();</line>
  <line number='1696'>			Collections.sort(result);</line>
  <line number='1697'>			</line>
  <line number='1698'>		} catch (Exception ex) {</line>
  <line number='1699'>			ex.printStackTrace();</line>
  <line number='1700'>			if (log.isDebugEnabled())</line>
  <line number='1701'>				log</line>
  <line number='1702'>						.debug("Authorization|||getObjects|Failure|Error in Obtaining Search Objects from Database |"</line>
  <line number='1703'>								+ ex.getMessage());</line>
  <line number='1704'>		}</line>
  <line number='1705'>		if (log.isDebugEnabled())</line>
  <line number='1706'>			log</line>
  <line number='1707'>					.debug("Authorization|||getObjects|Success|Successful in Searching objects from the database |");</line>
  <line number='1708'>		return result;</line>
  <line number='1748'>	 * </line>
  <line number='1749'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#getPrivilege(java.lang.String)</line>
  <line number='1750'>	 */</line>
  <line number='1751'></line>
  <line number='1752'>	/*</line>
  <line number='1753'>	 * (non-Javadoc)</line>
  <line number='1754'>	 * </line>
  <line number='1755'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#getProtectionElement(java.lang.String)</line>
  <line number='1756'>	 */</line>
  <line number='1757'>	public ProtectionElement getProtectionElement(String objectId,</line>
  <line number='1758'>			String attribute) throws CSObjectNotFoundException {</line>
  <line number='1759'>		Session s = null;</line>
  <line number='1760'>		ProtectionElement pe = null;</line>
  <line number='1761'>		if (StringUtilities.isBlank(objectId)) {</line>
  <line number='1762'>			throw new CSObjectNotFoundException(</line>
  <line number='1763'>					"The protection element can't be searched with null objectId");</line>
  <line number='1764'>		}</line>
  <line number='1765'>		try {</line>
  <line number='1766'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1767'></line>
  <line number='1796'>				log</line>
  <line number='1797'>						.error(</line>
  <line number='1798'>								"Authorization|||getProtectionElement|Failure|Error in obtaining Protection Element for object id "</line>
  <line number='1799'>										+ objectId</line>
  <line number='1800'>										+ " and attribute "</line>
  <line number='1801'>										+ attribute + "|", ex);</line>
  <line number='1802'>			throw new CSObjectNotFoundException(</line>
  <line number='1803'>					"Protection Element is not found with object id= "</line>
  <line number='1804'>							+ objectId + " and attributeName= " + attribute);</line>
  <line number='1805'>		} finally {</line>
  <line number='1806'>			try {</line>
  <line number='1807'>				s.close();</line>
  <line number='1808'>			} catch (Exception ex2) {</line>
  <line number='1809'>				if (log.isDebugEnabled())</line>
  <line number='1810'>					log</line>
  <line number='1811'>							.debug("Authorization|||getProtectionElement|Failure|Error in Closing Session |"</line>
  <line number='1812'>									+ ex2.getMessage());</line>
  <line number='1813'>			}</line>
  <line number='1814'>		}</line>
  <line number='1815'>		if (log.isDebugEnabled())</line>
  <line number='1866'>		} catch (Exception ex) {</line>
  <line number='1867'>			if (log.isDebugEnabled()) {</line>
  <line number='1868'>				log</line>
  <line number='1869'>						.debug("Authorization|||getProtectionGroup|Failure|Protection Group not found for name "</line>
  <line number='1870'>								+ protectionGroupName + "|" + ex.getMessage());</line>
  <line number='1871'>			}</line>
  <line number='1872'>			throw new CSObjectNotFoundException(</line>
  <line number='1873'>					"Protection Group not found for name "</line>
  <line number='1874'>							+ protectionGroupName);</line>
  <line number='1875'>		} finally {</line>
  <line number='1876'>			try {</line>
  <line number='1877'>				s.close();</line>
  <line number='1878'>			} catch (Exception ex2) {</line>
  <line number='1879'>				if (log.isDebugEnabled())</line>
  <line number='1880'>					log</line>
  <line number='1881'>							.debug("Authorization|||getProtectionGroup|Failure|Error in Closing Session |"</line>
  <line number='1882'>									+ ex2.getMessage());</line>
  <line number='1883'>			}</line>
  <line number='1884'>		}</line>
  <line number='1885'>		if (log.isDebugEnabled())</line>
  <line number='1915'>				throw new CSObjectNotFoundException("Role not found");</line>
  <line number='1916'>			}</line>
  <line number='1917'>			role = (Role) list.get(0);</line>
  <line number='1918'></line>
  <line number='1919'>		} catch (Exception ex) {</line>
  <line number='1920'>			if (log.isDebugEnabled())</line>
  <line number='1921'>				log</line>
  <line number='1922'>						.debug("Authorization|||getRole|Failure|Error in obtaining the Role for name "</line>
  <line number='1923'>								+ roleName + "|" + ex.getMessage());</line>
  <line number='1924'>		} finally {</line>
  <line number='1925'>			try {</line>
  <line number='1926'>				s.close();</line>
  <line number='1927'>			} catch (Exception ex2) {</line>
  <line number='1928'>				if (log.isDebugEnabled())</line>
  <line number='1929'>					log</line>
  <line number='1930'>							.debug("Authorization|||assignGroupRoleToProtectionGroup|Failure|Error in Closing Session |"</line>
  <line number='1931'>									+ ex2.getMessage());</line>
  <line number='1932'>			}</line>
  <line number='1933'>		}</line>
  <line number='1934'>		if (log.isDebugEnabled())</line>
  <line number='1938'>		return role;</line>
  <line number='1939'>	}</line>
  <line number='1940'></line>
  <line number='1941'>	/*</line>
  <line number='1942'>	 * (non-Javadoc)</line>
  <line number='1943'>	 * </line>
  <line number='1944'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#getUser(java.lang.String)</line>
  <line number='1945'>	 */</line>
  <line number='1946'>	public User getUser(String loginName) {</line>
  <line number='1947'>		Session s = null;</line>
  <line number='1948'>		User user = null;</line>
  <line number='1949'>		try {</line>
  <line number='1950'>			User search = new User();</line>
  <line number='1951'>			search.setLoginName(loginName);</line>
  <line number='1952'></line>
  <line number='1953'>			//String query = "FROM</line>
  <line number='1954'>			// gov.nih.nci.security.authorization.domianobjects.Application";</line>
  <line number='1955'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='1956'>			List list = s.createCriteria(User.class)</line>
  <line number='1957'>					.add(Example.create(search)).list();</line>
  <line number='1972'>		</line>
  <line number='1973'></line>
  <line number='1974'>		} catch (Exception ex) {</line>
  <line number='1975'></line>
  <line number='1976'>			if (log.isDebugEnabled())</line>
  <line number='1977'>				log.error(</line>
  <line number='1978'>						"Authorization|||getUser|Failure|Error Occured in Getting User for Name "</line>
  <line number='1979'>								+ loginName + "|", ex);</line>
  <line number='1980'></line>
  <line number='1981'>		} finally {</line>
  <line number='1982'>			try {</line>
  <line number='1983'>				s.close();</line>
  <line number='1984'>			} catch (Exception ex2) {</line>
  <line number='1985'>				if (log.isDebugEnabled())</line>
  <line number='1986'>					log</line>
  <line number='1987'>							.debug("Authorization|||getUser|Failure|Error in Closing Session |"</line>
  <line number='1988'>									+ ex2.getMessage());</line>
  <line number='1989'>			}</line>
  <line number='1990'>		}</line>
  <line number='1991'>		if (log.isDebugEnabled())</line>
  <line number='2027'></line>
  <line number='2028'>		} catch (Exception ex) {</line>
  <line number='2029'>			log.error(ex);</line>
  <line number='2030'>			if (log.isDebugEnabled())</line>
  <line number='2031'>				log</line>
  <line number='2032'>						.debug("Authorization|||getUsers|Failure|Error in obtaining Users for Group Id "</line>
  <line number='2033'>								+ groupId + "|" + ex.getMessage());</line>
  <line number='2034'>			throw new CSObjectNotFoundException(</line>
  <line number='2035'>					"An error occurred while obtaining Associated Users for the Group\n"</line>
  <line number='2036'>							+ ex.getMessage(), ex);</line>
  <line number='2037'>		} finally {</line>
  <line number='2038'>			try {</line>
  <line number='2039'>				s.close();</line>
  <line number='2040'>			} catch (Exception ex2) {</line>
  <line number='2041'>				if (log.isDebugEnabled())</line>
  <line number='2042'>					log</line>
  <line number='2043'>							.debug("Authorization|||getUsers|Failure|Error in Closing Session |"</line>
  <line number='2044'>									+ ex2.getMessage());</line>
  <line number='2045'>			}</line>
  <line number='2046'>		}</line>
  <line number='2047'>		if (log.isDebugEnabled())</line>
  <line number='2090'></line>
  <line number='2091'>	/*</line>
  <line number='2092'>	 * (non-Javadoc)</line>
  <line number='2093'>	 * </line>
  <line number='2094'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#removeGroupFromProtectionGroup(java.lang.String,</line>
  <line number='2095'>	 *      java.lang.String)</line>
  <line number='2096'>	 */</line>
  <line number='2097'>	public void removeGroupFromProtectionGroup(String protectionGroupId,</line>
  <line number='2098'>			String groupId) throws CSTransactionException {</line>
  <line number='2099'>		Session s = null;</line>
  <line number='2100'>		Transaction t = null;</line>
  <line number='2101'>		Connection connection = null;</line>
  <line number='2102'></line>
  <line number='2103'>		try {</line>
  <line number='2104'></line>
  <line number='2105'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='2106'>			t = s.beginTransaction();</line>
  <line number='2107'>			connection = s.connection();</line>
  <line number='2108'>			String sql = "delete from csm_user_group_role_pg where protection_group_id=? and group_id=?";</line>
  <line number='2109'>			PreparedStatement pstmt = connection.prepareStatement(sql);</line>
  <line number='2111'>			Long g_id = new Long(groupId);</line>
  <line number='2112'>			pstmt.setLong(1, pg_id.longValue());</line>
  <line number='2113'>			pstmt.setLong(2, g_id.longValue());</line>
  <line number='2114'></line>
  <line number='2115'>			int i = pstmt.executeUpdate();</line>
  <line number='2116'></line>
  <line number='2117'>			t.commit();</line>
  <line number='2118'>			s.flush();</line>
  <line number='2119'>			auditLog.info("Deassigning Roles and Protection Group Assignment from Group");</line>
  <line number='2120'>		} catch (Exception ex) {</line>
  <line number='2121'>			log.error(ex);</line>
  <line number='2122'>			try {</line>
  <line number='2123'>				t.rollback();</line>
  <line number='2124'>			} catch (Exception ex3) {</line>
  <line number='2125'>				if (log.isDebugEnabled())</line>
  <line number='2126'>					log</line>
  <line number='2127'>							.debug("Authorization|||removeGroupFromProtectionGroup|Failure|Error in Rolling Back Transaction|"</line>
  <line number='2128'>									+ ex3.getMessage());</line>
  <line number='2129'>			}</line>
  <line number='2130'>			if (log.isDebugEnabled())</line>
  <line number='2131'>				log</line>
  <line number='2132'>						.debug("Authorization|||assignGroupRoleToProtectionGroup|Failure|Error Occured in deassigning Group "</line>
  <line number='2133'>								+ groupId</line>
  <line number='2134'>								+ " and Protection Group"</line>
  <line number='2135'>								+ protectionGroupId + "|" + ex.getMessage());</line>
  <line number='2136'>			throw new CSTransactionException(</line>
  <line number='2137'>					"An error occured in deassigning Group and Protection Group\n"</line>
  <line number='2138'>							+ ex.getMessage(), ex);</line>
  <line number='2139'>		} finally {</line>
  <line number='2140'>			try {</line>
  <line number='2141'>				</line>
  <line number='2142'>				s.close();</line>
  <line number='2143'>				</line>
  <line number='2144'>			} catch (Exception ex2) {</line>
  <line number='2145'>				if (log.isDebugEnabled())</line>
  <line number='2146'>					log</line>
  <line number='2147'>							.debug("Authorization|||removeGroupFromProtectionGroup|Failure|Error in Closing Session |"</line>
  <line number='2148'>									+ ex2.getMessage());</line>
  <line number='2149'>			}</line>
  <line number='2156'>							+ protectionGroupId + "|");</line>
  <line number='2157'>	}</line>
  <line number='2158'></line>
  <line number='2159'>	/*</line>
  <line number='2160'>	 * (non-Javadoc)</line>
  <line number='2161'>	 * </line>
  <line number='2162'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#removeGroupRoleFromProtectionGroup(java.lang.String,</line>
  <line number='2163'>	 *      java.lang.String, java.lang.String[])</line>
  <line number='2164'>	 */</line>
  <line number='2165'>	public void removeGroupRoleFromProtectionGroup(String protectionGroupId,</line>
  <line number='2166'>			String groupId, String[] rolesId) throws CSTransactionException {</line>
  <line number='2167'>		Session s = null;</line>
  <line number='2168'>		Transaction t = null;</line>
  <line number='2169'></line>
  <line number='2170'>		try {</line>
  <line number='2171'></line>
  <line number='2172'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='2173'>			</line>
  <line number='2174'>			ProtectionGroup pgroup = (ProtectionGroup) this</line>
  <line number='2175'>			.getObjectByPrimaryKey(s, ProtectionGroup.class, new Long(</line>
  <line number='2176'>					protectionGroupId));</line>
  <line number='2177'>			</line>
  <line number='2178'>			Group group = (Group) this.getObjectByPrimaryKey(s, Group.class,</line>
  <line number='2179'>					new Long(groupId));</line>
  <line number='2180'>			</line>
  <line number='2181'>			</line>
  <line number='2182'>			</line>
  <line number='2183'>			ArrayList roles = new ArrayList();</line>
  <line number='2184'>			for (int i = 0; i &lt; rolesId.length; i++) {</line>
  <line number='2185'>				Role role = (Role) this.getObjectByPrimaryKey(s, Role.class,</line>
  <line number='2186'>						new Long(rolesId[i]));</line>
  <line number='2187'>				roles.add(role);</line>
  <line number='2188'>			}</line>
  <line number='2189'>			</line>
  <line number='2190'>			Criteria criteria = s.createCriteria(UserGroupRoleProtectionGroup.class);</line>
  <line number='2191'>			criteria.add(Restrictions.eq("protectionGroup", pgroup));</line>
  <line number='2192'>			criteria.add(Restrictions.eq("group", group));</line>
  <line number='2193'>	</line>
  <line number='2194'>			List list = criteria.list();</line>
  <line number='2195'>			t = s.beginTransaction();</line>
  <line number='2196'>			for(int k=0;k&lt;list.size();k++){</line>
  <line number='2197'>				UserGroupRoleProtectionGroup ugrpg = (UserGroupRoleProtectionGroup)list.get(k);</line>
  <line number='2198'>				Role r = ugrpg.getRole();</line>
  <line number='2199'>				if(roles.contains(r)){</line>
  <line number='2200'>					s.delete(ugrpg);	</line>
  <line number='2201'>				}</line>
  <line number='2202'>			}</line>
  <line number='2203'>			</line>
  <line number='2204'>			t.commit();</line>
  <line number='2205'>			s.flush();</line>
  <line number='2206'>			auditLog.info("Deassigning Roles From Group " + group.getGroupName() + " for Protection Group " + pgroup.getProtectionGroupName());</line>
  <line number='2207'>		} catch (Exception ex) {</line>
  <line number='2208'>			log.error(ex);</line>
  <line number='2209'>			try {</line>
  <line number='2210'>				t.rollback();</line>
  <line number='2211'>			} catch (Exception ex3) {</line>
  <line number='2212'>				if (log.isDebugEnabled())</line>
  <line number='2213'>					log</line>
  <line number='2214'>							.debug("Authorization|||removeGroupRoleFromProtectionGroup|Failure|Error in Rolling Back Transaction|"</line>
  <line number='2215'>									+ ex3.getMessage());</line>
  <line number='2216'>			}</line>
  <line number='2217'>			if (log.isDebugEnabled())</line>
  <line number='2218'>				log</line>
  <line number='2219'>						.debug("Authorization|||removeGroupRoleFromProtectionGroup|Failure|Error Occured in assigning Roles "</line>
  <line number='2220'>								+ StringUtilities.stringArrayToString(rolesId)</line>
  <line number='2221'>								+ " to Group "</line>
  <line number='2222'>								+ groupId</line>
  <line number='2223'>								+ " and Protection Group"</line>
  <line number='2224'>								+ protectionGroupId</line>
  <line number='2225'>								+ "|" + ex.getMessage());</line>
  <line number='2226'>			throw new CSTransactionException(</line>
  <line number='2227'>					"An error occured in assigning Roles and Protection Group to a Group\n"</line>
  <line number='2228'>							+ ex.getMessage(), ex);</line>
  <line number='2229'>		} finally {</line>
  <line number='2230'>			try {</line>
  <line number='2231'>				</line>
  <line number='2232'>				s.close();</line>
  <line number='2233'>			} catch (Exception ex2) {</line>
  <line number='2234'>				if (log.isDebugEnabled())</line>
  <line number='2235'>					log</line>
  <line number='2236'>							.debug("Authorization|||assignGroupRoleToProtectionGroup|Failure|Error in Closing Session |"</line>
  <line number='2237'>									+ ex2.getMessage());</line>
  <line number='2238'>			}</line>
  <line number='2239'>		}</line>
  <line number='2254'>	 */</line>
  <line number='2255'></line>
  <line number='2256'>	/*</line>
  <line number='2257'>	 * (non-Javadoc)</line>
  <line number='2258'>	 * </line>
  <line number='2259'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#removeUserFromGroup(java.lang.String,</line>
  <line number='2260'>	 *      java.lang.String)</line>
  <line number='2261'>	 */</line>
  <line number='2262'>	public void removeUserFromGroup(String groupId, String userId)</line>
  <line number='2263'>			throws CSTransactionException {</line>
  <line number='2264'></line>
  <line number='2265'>		Session s = null;</line>
  <line number='2266'>		Transaction t = null;</line>
  <line number='2267'></line>
  <line number='2268'>		try {</line>
  <line number='2269'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='2270'>			</line>
  <line number='2271'>			User user = (User) this.getObjectByPrimaryKey(s, User.class,</line>
  <line number='2272'>					new Long(userId));</line>
  <line number='2273'>			Group group = (Group) this.getObjectByPrimaryKey(s, Group.class,</line>
  <line number='2274'>					new Long(groupId));</line>
  <line number='2275'>			</line>
  <line number='2276'>			</line>
  <line number='2277'>			</line>
  <line number='2278'>			Set groups = user.getGroups();</line>
  <line number='2279'>			if (groups.contains(group)) {</line>
  <line number='2280'>				groups.remove(group);</line>
  <line number='2281'>				user.setGroups(groups);</line>
  <line number='2282'>				</line>
  <line number='2283'>				try {</line>
  <line number='2284'>					user = (User)performEncrytionDecryption(user, true);</line>
  <line number='2285'>				} catch (EncryptionException e) {</line>
  <line number='2286'>					throw new CSObjectNotFoundException(e);</line>
  <line number='2287'>				}</line>
  <line number='2288'>			</line>
  <line number='2289'>				</line>
  <line number='2290'>				t = s.beginTransaction();</line>
  <line number='2291'>				s.update(user);</line>
  <line number='2292'>				</line>
  <line number='2293'>				t.commit();</line>
  <line number='2294'>				s.flush();</line>
  <line number='2295'>			}else{</line>
  <line number='2296'>				//t.rollback();</line>
  <line number='2297'>			}</line>
  <line number='2298'></line>
  <line number='2299'>			//t.commit();</line>
  <line number='2300'>			//s.flush();</line>
  <line number='2301'>			auditLog.info("Deassigning User " + user.getLoginName() + " from Group " + group.getGroupName());</line>
  <line number='2302'>		} catch (Exception ex) {</line>
  <line number='2303'>			log.error(ex);</line>
  <line number='2304'>			try {</line>
  <line number='2305'>				t.rollback();</line>
  <line number='2306'>			} catch (Exception ex3) {</line>
  <line number='2307'>				if (log.isDebugEnabled())</line>
  <line number='2308'>					log</line>
  <line number='2309'>							.debug("Authorization|||removeUserFromGroup|Failure|Error in Rolling Back Transaction|"</line>
  <line number='2310'>									+ ex3.getMessage());</line>
  <line number='2311'>			}</line>
  <line number='2312'>			if (log.isDebugEnabled())</line>
  <line number='2313'>				log</line>
  <line number='2314'>						.debug("Authorization|||removeUserFromGroup|Failure|Error Occured in deassigning User "</line>
  <line number='2315'>								+ userId</line>
  <line number='2316'>								+ " from Group "</line>
  <line number='2317'>								+ groupId</line>
  <line number='2318'>								+ "|"</line>
  <line number='2319'>								+ ex.getMessage());</line>
  <line number='2320'>			throw new CSTransactionException(</line>
  <line number='2321'>					"An error occured in deassigning User from a Group\n"</line>
  <line number='2322'>							+ ex.getMessage(), ex);</line>
  <line number='2323'>		} finally {</line>
  <line number='2324'>			try {</line>
  <line number='2325'>				</line>
  <line number='2326'>				s.close();</line>
  <line number='2327'>			} catch (Exception ex2) {</line>
  <line number='2328'>				if (log.isDebugEnabled())</line>
  <line number='2329'>					log</line>
  <line number='2330'>							.debug("Authorization|||removeUserFromGroup|Failure|Error in Closing Session |"</line>
  <line number='2331'>									+ ex2.getMessage());</line>
  <line number='2332'>			}</line>
  <line number='2333'>		}</line>
  <line number='2339'></line>
  <line number='2340'>	/*</line>
  <line number='2341'>	 * (non-Javadoc)</line>
  <line number='2342'>	 * </line>
  <line number='2343'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#removeUserFromProtectionGroup(java.lang.String,</line>
  <line number='2344'>	 *      java.lang.String)</line>
  <line number='2345'>	 */</line>
  <line number='2346'>	public void removeUserFromProtectionGroup(String protectionGroupId,</line>
  <line number='2347'>			String userId) throws CSTransactionException {</line>
  <line number='2348'>		Session s = null;</line>
  <line number='2349'>		Transaction t = null;</line>
  <line number='2350'>		Connection connection = null;</line>
  <line number='2351'></line>
  <line number='2352'>		try {</line>
  <line number='2353'></line>
  <line number='2354'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='2355'>			t = s.beginTransaction();</line>
  <line number='2356'>			connection = s.connection();</line>
  <line number='2357'>			String sql = "delete from csm_user_group_role_pg where protection_group_id=? and user_id=?";</line>
  <line number='2358'>			PreparedStatement pstmt = connection.prepareStatement(sql);</line>
  <line number='2360'>			Long u_id = new Long(userId);</line>
  <line number='2361'>			pstmt.setLong(1, pg_id.longValue());</line>
  <line number='2362'>			pstmt.setLong(2, u_id.longValue());</line>
  <line number='2363'></line>
  <line number='2364'>			int i = pstmt.executeUpdate();</line>
  <line number='2365'>			pstmt.close();</line>
  <line number='2366'>			t.commit();</line>
  <line number='2367'>			s.flush();</line>
  <line number='2368'>			auditLog.info("Deassigning Roles and Protection Group Assignment from User");</line>
  <line number='2369'>		} catch (Exception ex) {</line>
  <line number='2370'>			log.error(ex);</line>
  <line number='2371'>			try {</line>
  <line number='2372'>				t.rollback();</line>
  <line number='2373'>			} catch (Exception ex3) {</line>
  <line number='2374'>				if (log.isDebugEnabled())</line>
  <line number='2375'>					log</line>
  <line number='2376'>							.debug("Authorization|||removeUserFromProtectionGroup|Failure|Error in Rolling Back Transaction|"</line>
  <line number='2377'>									+ ex3.getMessage());</line>
  <line number='2378'>			}</line>
  <line number='2379'>			if (log.isDebugEnabled())</line>
  <line number='2380'>				log</line>
  <line number='2381'>						.debug("Authorization|||removeUserFromProtectionGroup|Failure|Error Occured in deassigning User "</line>
  <line number='2382'>								+ userId</line>
  <line number='2383'>								+ " from Protection Group "</line>
  <line number='2384'>								+ protectionGroupId + "|" + ex.getMessage());</line>
  <line number='2385'>			throw new CSTransactionException(</line>
  <line number='2386'>					"An error occured in deassigning User from Protection Group\n"</line>
  <line number='2387'>							+ ex.getMessage(), ex);</line>
  <line number='2388'>		} finally {</line>
  <line number='2389'>			try {</line>
  <line number='2390'>				</line>
  <line number='2391'>				</line>
  <line number='2392'>				s.close();</line>
  <line number='2393'></line>
  <line number='2394'>			} catch (Exception ex2) {</line>
  <line number='2395'>				if (log.isDebugEnabled())</line>
  <line number='2396'>					log</line>
  <line number='2397'>							.debug("Authorization|||removeUserFromProtectionGroup|Failure|Error in Closing Session |"</line>
  <line number='2398'>									+ ex2.getMessage());</line>
  <line number='2406'>							+ protectionGroupId + "|");</line>
  <line number='2407'>	}</line>
  <line number='2408'></line>
  <line number='2409'>	/*</line>
  <line number='2410'>	 * (non-Javadoc)</line>
  <line number='2411'>	 * </line>
  <line number='2412'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#removeUserRoleFromProtectionGroup(java.lang.String,</line>
  <line number='2413'>	 *      java.lang.String, java.lang.String[])</line>
  <line number='2414'>	 */</line>
  <line number='2415'>	public void removeUserRoleFromProtectionGroup(String protectionGroupId,</line>
  <line number='2416'>			String userId, String[] rolesId) throws CSTransactionException {</line>
  <line number='2417'>		Session s = null;</line>
  <line number='2418'>		Transaction t = null;</line>
  <line number='2419'></line>
  <line number='2420'>		try {</line>
  <line number='2421'></line>
  <line number='2422'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='2423'>			</line>
  <line number='2424'>			ProtectionGroup pgroup = (ProtectionGroup) this</line>
  <line number='2425'>			.getObjectByPrimaryKey(s, ProtectionGroup.class, new Long(</line>
  <line number='2534'></line>
  <line number='2535'>	}</line>
  <line number='2536'></line>
  <line number='2537'>	/*</line>
  <line number='2538'>	 * (non-Javadoc)</line>
  <line number='2539'>	 * </line>
  <line number='2540'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#setOwnerForProtectionElement(java.lang.String,</line>
  <line number='2541'>	 *      java.lang.String, java.lang.String)</line>
  <line number='2542'>	 */</line>
  <line number='2543'>	public void setOwnerForProtectionElement(String loginName, String protectionElementObjectId, String protectionElementAttributeName)	throws CSTransactionException {</line>
  <line number='2544'></line>
  <line number='2545'>		Session s = null;</line>
  <line number='2546'>		Transaction t = null;</line>
  <line number='2547'>		if (StringUtilities.isBlank(loginName)) {</line>
  <line number='2548'>			throw new CSTransactionException("Login Name can't be null");</line>
  <line number='2549'>		}</line>
  <line number='2550'>		if (StringUtilities.isBlank(protectionElementObjectId)) {</line>
  <line number='2551'>			throw new CSTransactionException("Object Id can't be null");</line>
  <line number='2552'>		}</line>
  <line number='2553'>		try {</line>
  <line number='2638'>							+ loginName + "|");</line>
  <line number='2639'>	}</line>
  <line number='2640'></line>
  <line number='2641'>	/*</line>
  <line number='2642'>	 * (non-Javadoc)</line>
  <line number='2643'>	 * </line>
  <line number='2644'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#setOwnerForProtectionElement(java.lang.String,</line>
  <line number='2645'>	 *      java.lang.String)</line>
  <line number='2646'>	 */</line>
  <line number='2647'>	public void setOwnerForProtectionElement(String protectionElementObjectId,</line>
  <line number='2648'>			String[] userNames) throws CSTransactionException {</line>
  <line number='2649'></line>
  <line number='2650'>		Session s = null;</line>
  <line number='2651'>		Transaction t = null;</line>
  <line number='2652'>		if (StringUtilities.isBlank(protectionElementObjectId)) {</line>
  <line number='2653'>			throw new CSTransactionException("object Id can't be null!");</line>
  <line number='2654'>		}</line>
  <line number='2655'>		try {</line>
  <line number='2656'>			</line>
  <line number='2657'></line>
  <line number='2847'>	 * </line>
  <line number='2848'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#deAssignProtectionElements(java.lang.String[],</line>
  <line number='2849'>	 *      java.lang.String)</line>
  <line number='2850'>	 */</line>
  <line number='2851'>	/**</line>
  <line number='2852'>	 * @param protectionGroupName</line>
  <line number='2853'>	 * @param protectionElementObjectId</line>
  <line number='2854'>	 *  </line>
  <line number='2855'>	 */</line>
  <line number='2856'>	public void deAssignProtectionElements(String protectionGroupName,</line>
  <line number='2857'>			String protectionElementObjectId)</line>
  <line number='2858'>			throws CSTransactionException {</line>
  <line number='2859'></line>
  <line number='2860'> 		Session s = null;</line>
  <line number='2861'>		Transaction t = null;</line>
  <line number='2862'>		try {</line>
  <line number='2863'></line>
  <line number='2864'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='2865'>			t = s.beginTransaction();</line>
  <line number='2866'></line>
  <line number='2935'>			log</line>
  <line number='2936'>					.debug("Authorization|||deAssignProtectionElements|Success|Successful in deassigning Protection Element with Object Id "</line>
  <line number='2937'>							+ protectionElementObjectId</line>
  <line number='2938'>							+ " from protection group name: "</line>
  <line number='2939'>							+ protectionGroupName + "|");</line>
  <line number='2940'>	}</line>
  <line number='2941'></line>
  <line number='2942'></line>
  <line number='2943'></line>
  <line number='2944'>	public void removeProtectionElementsFromProtectionGroup(</line>
  <line number='2945'>			String protectionGroupId, String[] protectionElementIds)</line>
  <line number='2946'>			throws CSTransactionException {</line>
  <line number='2947'>		Session s = null;</line>
  <line number='2948'>		Transaction t = null;</line>
  <line number='2949'>		</line>
  <line number='2950'>		Set pgpes = new HashSet();</line>
  <line number='2951'>		try {</line>
  <line number='2952'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='2953'>			</line>
  <line number='2954'></line>
  <line number='3136'>									+ ex2.getMessage());</line>
  <line number='3137'>			}</line>
  <line number='3138'>		}</line>
  <line number='3139'>		if (log.isDebugEnabled())</line>
  <line number='3140'>			log</line>
  <line number='3141'>					.debug("Authorization|||removeObject|Success|Success in removing object of type "</line>
  <line number='3142'>							+ oj.getClass().getName() + "|");</line>
  <line number='3143'>	}</line>
  <line number='3144'></line>
  <line number='3145'>	private Application getApplicationByName(String contextName)</line>
  <line number='3146'>			throws CSObjectNotFoundException {</line>
  <line number='3147'>		Session s = null;</line>
  <line number='3148'>		Application app = null;</line>
  <line number='3149'>		try {</line>
  <line number='3150'>			Application search = new Application();</line>
  <line number='3151'>			search.setApplicationName(contextName);</line>
  <line number='3152'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='3153'>		</line>
  <line number='3154'>			Query q = s.createQuery("from Application as app where app.applicationName='"+contextName+"'");</line>
  <line number='3155'>			List list = q.list();</line>
  <line number='3223'></line>
  <line number='3224'>	}</line>
  <line number='3225'></line>
  <line number='3226'>	/*</line>
  <line number='3227'>	 * (non-Javadoc)</line>
  <line number='3228'>	 * </line>
  <line number='3229'>	 * @see gov.nih.nci.security.UserProvisioningManager#getProtectionGroupRoleContext()</line>
  <line number='3230'>	 *      We might not implement this method</line>
  <line number='3231'>	 */</line>
  <line number='3232'>	public Set getProtectionGroupRoleContextForUser(String userId)</line>
  <line number='3233'>			throws CSObjectNotFoundException {</line>
  <line number='3234'>		Set result = new HashSet();</line>
  <line number='3235'>		Session s = null;</line>
  <line number='3236'></line>
  <line number='3237'>		Connection connection = null;</line>
  <line number='3238'>		ArrayList pgIds = new ArrayList();</line>
  <line number='3239'>		try {</line>
  <line number='3240'>			</line>
  <line number='3241'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='3242'></line>
  <line number='3333'>			}</line>
  <line number='3334'>		}</line>
  <line number='3335'>		if (log.isDebugEnabled())</line>
  <line number='3336'>			log</line>
  <line number='3337'>					.debug("Authorization|||getProtectionGroupRoleContextForUser|Success|Successful in obtaining the Protection Group - Role Context for the User Id "</line>
  <line number='3338'>							+ userId + "|");</line>
  <line number='3339'>		return result;</line>
  <line number='3340'>	}</line>
  <line number='3341'></line>
  <line number='3342'>	public Set getProtectionGroupRoleContextForGroup(String groupId)</line>
  <line number='3343'>			throws CSObjectNotFoundException {</line>
  <line number='3344'>		Set result = new HashSet();</line>
  <line number='3345'>		</line>
  <line number='3346'>		Session s = null;</line>
  <line number='3347'>		Connection connection = null;</line>
  <line number='3348'>		ArrayList pgIds = new ArrayList();</line>
  <line number='3349'>		try {</line>
  <line number='3350'>			</line>
  <line number='3351'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='3352'></line>
  <line number='3448'>			log</line>
  <line number='3449'>					.debug("Authorization|||getProtectionGroupRoleContextForUser|Success|Successful in obtaining the Protection Group - Role Context for the Group Id "</line>
  <line number='3450'>							+ groupId + "|");</line>
  <line number='3451'>		return result;</line>
  <line number='3452'>	}</line>
  <line number='3453'></line>
  <line number='3454'>	/* (non-Javadoc)</line>
  <line number='3455'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#getProtectionElementPrivilegeContextForUser(java.lang.String)</line>
  <line number='3456'>	 */</line>
  <line number='3457'>	public Set getProtectionElementPrivilegeContextForUser(String userId) throws CSObjectNotFoundException {</line>
  <line number='3458'>		Set protectionElementPrivilegeContextSet = new HashSet();</line>
  <line number='3459'></line>
  <line number='3460'>		Session s = null;</line>
  <line number='3461'>		Connection connection = null;</line>
  <line number='3462'>		PreparedStatement preparedStatement = null;</line>
  <line number='3463'>		ResultSet rs = null;</line>
  <line number='3464'>		</line>
  <line number='3465'>		String currPEId = null;</line>
  <line number='3466'>		String prevPEId = null;</line>
  <line number='3467'></line>
  <line number='3541'>			}</line>
  <line number='3542'>		}</line>
  <line number='3543'>		if (log.isDebugEnabled())</line>
  <line number='3544'>			log.debug("Authorization|||getProtectionElementPrivilegeContextForUser|Success|Successful in Obtaining the PE Privileges Map|");</line>
  <line number='3545'>		return protectionElementPrivilegeContextSet;</line>
  <line number='3546'>	}</line>
  <line number='3547'>	/* (non-Javadoc)</line>
  <line number='3548'>	 * @see gov.nih.nci.security.dao.AuthorizationDAO#getProtectionElementPrivilegeContextForGroup(java.lang.String)</line>
  <line number='3549'>	 */</line>
  <line number='3550'>	public Set getProtectionElementPrivilegeContextForGroup(String groupId) throws CSObjectNotFoundException {</line>
  <line number='3551'>		Set protectionElementPrivilegeContextSet = new HashSet();</line>
  <line number='3552'></line>
  <line number='3553'>		Session s = null;</line>
  <line number='3554'>		Connection connection = null;</line>
  <line number='3555'>		PreparedStatement preparedStatement = null;</line>
  <line number='3556'>		ResultSet rs = null;</line>
  <line number='3557'>		</line>
  <line number='3558'>		String currPEId = null;</line>
  <line number='3559'>		String prevPEId = null;</line>
  <line number='3560'></line>
  <line number='3631'>				if (log.isDebugEnabled())</line>
  <line number='3632'>					log.debug("Authorization|||getProtectionElementPrivilegeContextForGroup|Failure|Error in Closing Session |" + ex2.getMessage());</line>
  <line number='3633'>			}</line>
  <line number='3634'>		}</line>
  <line number='3635'>		if (log.isDebugEnabled())</line>
  <line number='3636'>			log.debug("Authorization|||getProtectionElementPrivilegeContextForGroup|Success|Successful in Obtaining the PE Privileges Map|");</line>
  <line number='3637'>		return protectionElementPrivilegeContextSet;</line>
  <line number='3638'>	}</line>
  <line number='3639'>	</line>
  <line number='3640'>	public void modifyObject(Object obj) throws CSTransactionException {</line>
  <line number='3641'>		Session s = null;</line>
  <line number='3642'>		Transaction t = null;</line>
  <line number='3643'>		try {</line>
  <line number='3644'>			s = HibernateSessionFactoryHelper.getAuditSession(sf);</line>
  <line number='3645'>			t = s.beginTransaction();</line>
  <line number='3646'></line>
  <line number='3647'>			</line>
  <line number='3648'>			try {</line>
  <line number='3649'>				obj = performEncrytionDecryption(obj, true);</line>
  <line number='3650'>			} catch (EncryptionException e) {</line>
  <line number='3728'></line>
  <line number='3729'>	}</line>
  <line number='3730'></line>
  <line number='3731'>	</line>
  <line number='3732'></line>
  <line number='3733'>	public Application getApplication() {</line>
  <line number='3734'>		return this.application;</line>
  <line number='3735'>	}</line>
  <line number='3736'></line>
  <line number='3737'>	public void createObject(Object obj) throws CSTransactionException {</line>
  <line number='3738'>		Session s = null;</line>
  <line number='3739'>		Transaction t = null;</line>
  <line number='3740'>		try {</line>
  <line number='3741'>			</line>
  <line number='3742'>			try {</line>
  <line number='3743'>				obj = performEncrytionDecryption(obj, true);</line>
  <line number='3744'>			} catch (EncryptionException e) {</line>
  <line number='3745'>				throw new CSObjectNotFoundException(e);</line>
  <line number='3746'>			}</line>
  <line number='3747'>			</line>
  <line number='4184'>									+ ex2.getMessage());</line>
  <line number='4185'>			}</line>
  <line number='4186'>		}</line>
  <line number='4187'>		if (log.isDebugEnabled())</line>
  <line number='4188'>			log</line>
  <line number='4189'>					.debug("Authorization|||getObjectAccessMap|Success|Successful in Obtaining the Object Access Map|");</line>
  <line number='4190'>		return new ObjectAccessMap(objectTypeName, accessMap);</line>
  <line number='4191'>	}</line>
  <line number='4192'></line>
  <line number='4193'>	public Object secureObject(String userName, Object obj) throws CSException {</line>
  <line number='4194'>		Object o = null;</line>
  <line number='4195'>		if (StringUtilities.isBlank(userName)) {</line>
  <line number='4196'>			throw new CSException("No user name have been supplied!");</line>
  <line number='4197'>		}</line>
  <line number='4198'>		if (obj == null) {</line>
  <line number='4199'>			return obj;</line>
  <line number='4200'>		}</line>
  <line number='4201'>		Field[] fields = obj.getClass().getDeclaredFields();</line>
  <line number='4202'>		for (int i=0; i &lt; fields.length; i++)</line>
  <line number='4203'>		{</line>
  <line number='4311'></line>
  <line number='4312'>			throw new CSException("Failed to secure Collection:"</line>
  <line number='4313'>					+ ex.getMessage(), ex);</line>
  <line number='4314'>		}</line>
  <line number='4315'></line>
  <line number='4316'>		return result;</line>
  <line number='4317'></line>
  <line number='4318'>	}</line>
  <line number='4319'></line>
  <line number='4320'>	public Object secureUpdate(String userName, Object originalObject,</line>
  <line number='4321'>			Object mutatedObject) throws CSException {</line>
  <line number='4322'>		//Object o = null;</line>
  <line number='4323'>		if (StringUtilities.isBlank(userName)) {</line>
  <line number='4324'>			throw new CSException("No user name have been supplied!");</line>
  <line number='4325'>		}</line>
  <line number='4326'>		if (originalObject == null || mutatedObject == null) {</line>
  <line number='4327'>			return originalObject;</line>
  <line number='4328'>		}</line>
  <line number='4329'>		try {</line>
  <line number='4330'></line>
  <line number='4561'>			log</line>
  <line number='4562'>					.debug("Authorization||"</line>
  <line number='4563'>							+ userName</line>
  <line number='4564'>							+ "|checkOwnerShip|Success|Successful in checking ownership for user "</line>
  <line number='4565'>							+ userName + " and Protection Element "</line>
  <line number='4566'>							+ protectionElementObjectId + "|");</line>
  <line number='4567'>		return test;</line>
  <line number='4568'>	}</line>
  <line number='4569'></line>
  <line number='4570'>	public Collection getPrivilegeMap(String userName, Collection pEs)</line>
  <line number='4571'>			throws CSException {</line>
  <line number='4572'>		ArrayList result = new ArrayList();</line>
  <line number='4573'>		ResultSet rs = null;</line>
  <line number='4574'>		PreparedStatement pstmt = null;</line>
  <line number='4575'>		boolean test = false;</line>
  <line number='4576'>		Session s = null;</line>
  <line number='4577'></line>
  <line number='4578'>		Connection connection = null;</line>
  <line number='4579'></line>
  <line number='4580'>		if (StringUtilities.isBlank(userName)) {</line>
  <line number='4712'>		</line>
  <line number='4713'>		return obj;		</line>
  <line number='4714'>	}</line>
  <line number='4715'></line>
  <line number='4716'>	public Application getApplication(String applicationContextName) throws CSObjectNotFoundException</line>
  <line number='4717'>	{</line>
  <line number='4718'>		return getApplicationByName(applicationContextName);</line>
  <line number='4719'>	}</line>
  <line number='4720'>	</line>
  <line number='4721'>	public void removeOwnerForProtectionElement(String loginName, String protectionElementObjectId, String protectionElementAttributeName)	throws CSTransactionException {</line>
  <line number='4722'></line>
  <line number='4723'>		Session s = null;</line>
  <line number='4724'>		Transaction t = null;</line>
  <line number='4725'>		if (StringUtilities.isBlank(loginName)) {</line>
  <line number='4726'>			throw new CSTransactionException("Login Name can't be null");</line>
  <line number='4727'>		}</line>
  <line number='4728'>		if (StringUtilities.isBlank(protectionElementObjectId)) {</line>
  <line number='4729'>			throw new CSTransactionException("Object Id can't be null");</line>
  <line number='4730'>		}</line>
  <line number='4731'>		try {</line>
  <line number='4810'>			log</line>
  <line number='4811'>					.debug("Authorization|||setOwnerForProtectionElement|Success|Success in removing owner for Protection Element object Name"</line>
  <line number='4812'>							+ protectionElementObjectId</line>
  <line number='4813'>							+ " and Attribute Id "</line>
  <line number='4814'>							+ protectionElementAttributeName</line>
  <line number='4815'>							+ " for user "</line>
  <line number='4816'>							+ loginName + "|");</line>
  <line number='4817'>	}</line>
  <line number='4818'>	</line>
  <line number='4819'>	public void removeOwnerForProtectionElement(String protectionElementObjectId,</line>
  <line number='4820'>			String[] userNames) throws CSTransactionException {</line>
  <line number='4821'></line>
  <line number='4822'>		Session s = null;</line>
  <line number='4823'>		Transaction t = null;</line>
  <line number='4824'>		if (StringUtilities.isBlank(protectionElementObjectId)) {</line>
  <line number='4825'>			throw new CSTransactionException("object Id can't be null!");</line>
  <line number='4826'>		}</line>
  <line number='4827'>		try {</line>
  <line number='4828'>			</line>
  <line number='4829'></line>
  <type type='checkstyle' number='44' suppressed='0'/>
  <type type='simian' number='234' suppressed='134'/>
</file>
